<TeXmacs|1.0.7.19>

<style|generic>

<\body>
  <\render-exercise|Exercise 2.82>
    <render-footnote|*|Creative Commons <image|<tuple|<#89504E470D0A1A0A0000000D49484452000000580000001F080600000063C80AE0000000097048597300000B1300000B1301009A9C1800000A4F6943435050686F746F73686F70204943432070726F66696C65000078DA9D53675453E9163DF7DEF4424B8880944B6F5215082052428B801491262A2109104A8821A1D91551C1114545041BC8A088038E8E808C15512C0C8A0AD807E421A28E83A3888ACAFBE17BA36BD6BCF7E6CDFEB5D73EE7ACF39DB3CF07C0080C9648335135800CA9421E11E083C7C4C6E1E42E40810A2470001008B3642173FD230100F87E3C3C2B22C007BE000178D30B0800C04D9BC0301C87FF0FEA42995C01808401C07491384B08801400407A8E42A600404601809D98265300A0040060CB6362E300502D0060277FE6D300809DF8997B01005B94211501A09100201365884400683B00ACCF568A450058300014664BC43900D82D00304957664800B0B700C0CE100BB200080C00305188852900047B0060C8232378008499001446F2573CF12BAE10E72A00007899B23CB9243945815B082D710757572E1E28CE49172B14366102619A402EC27999193281340FE0F3CC0000A0911511E083F3FD78CE0EAECECE368EB60E5F2DEABF06FF226262E3FEE5CFAB70400000E1747ED1FE2C2FB31A803B06806DFEA225EE04685E0BA075F78B66B20F40B500A0E9DA57F370F87E3C3C45A190B9D9D9E5E4E4D84AC4425B61CA577DFE67C25FC057FD6CF97E3CFCF7F5E0BEE22481325D814704F8E0C2CCF44CA51CCF92098462DCE68F47FCB70BFFFC1DD322C44962B9582A14E35112718E449A8CF332A52289429229C525D2FF64E2DF2CFB033EDF3500B06A3E017B912DA85D6303F64B27105874C0E2F70000F2BB6FC1D4280803806883E1CF77FFEF3FFD47A02500806649927100005E44242E54CAB33FC708000044A0812AB0411BF4C1182CC0061CC105DCC10BFC6036844224C4C24210420A64801C726029AC82422886CDB01D2A602FD4401D34C051688693700E2EC255B80E3D700FFA61089EC128BC81090441C808136121DA8801628A58238E08179985F821C14804128B2420C9881451224B91354831528A542055481DF23D720239875C46BA913BC8003282FC86BC47319481B2513DD40CB543B9A8371A8446A20BD06474319A8F16A09BD072B41A3D8C36A1E7D0AB680FDA8F3E43C730C0E8180733C46C302EC6C342B1382C099363CBB122AC0CABC61AB056AC03BB89F563CFB17704128145C0093604774220611E4148584C584ED848A8201C243411DA093709038451C2272293A84BB426BA11F9C4186232318758482C23D6128F132F107B8843C437241289433227B9900249B1A454D212D246D26E5223E92CA99B34481A2393C9DA646BB20739942C202BC885E49DE4C3E433E41BE421F25B0A9D624071A4F853E22852CA6A4A19E510E534E5066598324155A39A52DDA8A15411358F5A42ADA1B652AF5187A81334759A39CD8316494BA5ADA295D31A681768F769AFE874BA11DD951E4E97D057D2CBE947E897E803F4770C0D861583C7886728199B18071867197718AF984CA619D38B19C754303731EB98E7990F996F55582AB62A7C1591CA0A954A9526951B2A2F54A9AAA6AADEAA0B55F355CB548FA95E537DAE46553353E3A909D496AB55AA9D50EB531B5367A93BA887AA67A86F543FA47E59FD890659C34CC34F43A451A0B15FE3BCC6200B6319B3782C216B0DAB86758135C426B1CDD97C762ABB98FD1DBB8B3DAAA9A13943334A3357B352F394663F07E39871F89C744E09E728A797F37E8ADE14EF29E2291BA6344CB931655C6BAA96979658AB48AB51AB47EBBD36AEEDA79DA6BD45BB59FB810E41C74A275C2747678FCE059DE753D953DDA70AA7164D3D3AF5AE2EAA6BA51BA1BB4477BF6EA7EE989EBE5E809E4C6FA7DE79BDE7FA1C7D2FFD54FD6DFAA7F5470C5806B30C2406DB0CCE183CC535716F3C1D2FC7DBF151435DC34043A561956197E18491B9D13CA3D5468D460F8C69C65CE324E36DC66DC6A326062621264B4DEA4DEE9A524DB9A629A63B4C3B4CC7CDCCCDA2CDD699359B3D31D732E79BE79BD79BDFB7605A785A2CB6A8B6B86549B2E45AA659EEB6BC6E855A3959A558555A5DB346AD9DAD25D6BBADBBA711A7B94E934EAB9ED667C3B0F1B6C9B6A9B719B0E5D806DBAEB66DB67D6167621767B7C5AEC3EE93BD937DBA7D8DFD3D070D87D90EAB1D5A1D7E73B472143A563ADE9ACE9CEE3F7DC5F496E92F6758CF10CFD833E3B613CB29C4699D539BD347671767B97383F3888B894B82CB2E973E2E9B1BC6DDC8BDE44A74F5715DE17AD2F59D9BB39BC2EDA8DBAFEE36EE69EE87DC9FCC349F299E593373D0C3C843E051E5D13F0B9F95306BDFAC7E4F434F8167B5E7232F632F9157ADD7B0B7A577AAF761EF173EF63E729FE33EE33C37DE32DE595FCC37C0B7C8B7CB4FC36F9E5F85DF437F23FF64FF7AFFD100A78025016703898141815B02FBF87A7C21BF8E3F3ADB65F6B2D9ED418CA0B94115418F82AD82E5C1AD2168C8EC90AD21F7E798CE91CE690E85507EE8D6D00761E6618BC37E0C2785878557863F8E7088581AD131973577D1DC4373DF44FA449644DE9B67314F39AF2D4A352A3EAA2E6A3CDA37BA34BA3FC62E6659CCD5589D58496C4B1C392E2AAE366E6CBEDFFCEDF387E29DE20BE37B17982FC85D7079A1CEC2F485A716A92E122C3A96404C884E3894F041102AA8168C25F21377258E0A79C21DC267222FD136D188D8435C2A1E4EF2482A4D7A92EC91BC357924C533A52CE5B98427A990BC4C0D4CDD9B3A9E169A76206D323D3ABD31839291907142AA214D93B667EA67E66676CBAC6585B2FEC56E8BB72F1E9507C96BB390AC05592D0AB642A6E8545A28D72A07B267655766BFCD89CA3996AB9E2BCDEDCCB3CADB90379CEF9FFFED12C212E192B6A5864B572D1D58E6BDAC6A39B23C7179DB0AE315052B865606AC3CB88AB62A6DD54FABED5797AE7EBD267A4D6B815EC1CA82C1B5016BEB0B550AE5857DEBDCD7ED5D4F582F59DFB561FA869D1B3E15898AAE14DB1797157FD828DC78E51B876FCABF99DC94B4A9ABC4B964CF66D266E9E6DE2D9E5B0E96AA97E6970E6E0DD9DAB40DDF56B4EDF5F645DB2F97CD28DBBB83B643B9A3BF3CB8BC65A7C9CECD3B3F54A454F454FA5436EED2DDB561D7F86ED1EE1B7BBCF634ECD5DB5BBCF7FD3EC9BEDB5501554DD566D565FB49FBB3F73FAE89AAE9F896FB6D5DAD4E6D71EDC703D203FD07230EB6D7B9D4D51DD23D54528FD62BEB470EC71FBEFE9DEF772D0D360D558D9CC6E223704479E4E9F709DFF71E0D3ADA768C7BACE107D31F761D671D2F6A429AF29A469B539AFB5B625BBA4FCC3ED1D6EADE7AFC47DB1F0F9C343C59794AF354C969DAE982D39367F2CF8C9D959D7D7E2EF9DC60DBA2B67BE763CEDF6A0F6FEFBA1074E1D245FF8BE73BBC3BCE5CF2B874F2B2DBE51357B8579AAF3A5F6DEA74EA3CFE93D34FC7BB9CBB9AAEB95C6BB9EE7ABDB57B66F7E91B9E37CEDDF4BD79F116FFD6D59E393DDDBDF37A6FF7C5F7F5DF16DD7E7227FDCECBBBD97727EEADBC4FBC5FF440ED41D943DD87D53F5BFEDCD8EFDC7F6AC077A0F3D1DC47F7068583CFFE91F58F0F43058F998FCB860D86EB9E383E3939E23F72FDE9FCA743CF64CF269E17FEA2FECBAE17162F7EF8D5EBD7CED198D1A197F29793BF6D7CA5FDEAC0EB19AFDBC6C2C61EBEC97833315EF456FBEDC177DC771DEFA3DF0F4FE47C207F28FF68F9B1F553D0A7FB93199393FF040398F3FC63332DDB0000000467414D410000B18E7CFB5193000000206348524D00007A25000080830000F9FF000080E9000075300000EA6000003A980000176F925FC54600000A6F4944415478DAEC5A6D6C53D7197EEEB58946273CFFDB2607618436C591561C0AB474B4B1D7AD534BD35C2F295FA1C3665ADB9575494A08DBC897814063421DF7539BD6C46B57B55AA9305F6B173A7C43D0E2C4496C468BF363958D92A8549BE6E0A0A9C41FEF7E5CDF13DFC44E1C68D58EF6958EEFF13DE73CF7DCE7BCE73DEF79CFE58848C371DC557C259FBA1011C701200038DD7D0A3CCF83E779A8542AF0BC0A2A9E07AF4A5F791E1CC783E738701C07709C8C020281528414A5904A4929994C4AD75412C9640AA9549295A528C5EA1391DC1996BF15E491F28D00000E00C9E4AA542A29F1AAE9BC4A2595F1AA34C91C388ECFE4374D4E9AD894446632994E99F9A492E4542AC588CD24FA5622590D4049AE4A0DB5E22AA593C74FC1EBF56260600093B14905D012CD12AC5DBB16E61F9851F6F04348A654E0F9843420491E1CB8F458664C9F14493301E939C449E40EFB03F0BCED41281452D437180C102A04AC5A5392D7CB7D51703800F4D7B3EF42AD563352D56AB594546AF488E7E078C681F1F1F1BC3AA4D3E950FF9B7A9496DE8B44328964328144229D9209241249A6E1999AFCD1F84778BEE3058C8446000026930946A31100100C06218A2200A0C850849DD53BF1AD6F7F33EBF3AF7CF4315E74BDF885C079A47CA344F07B3D67A056A9A789552FC222B51ACD8D2DF01CF3B0065AAD16822040AFD7A3B4B41400D0D3D3834824028FC7838989095657B008A8ABDF85C5B72D462291403C91402211472291509A0C4AE16AF42A7EF9C45388C5621004014EA7137ABD5ED1D9482482DADA5A783C1E68341AB43A5A67BDD4B5D83554EFACF9C2E0C87698CEF69EA5DEBE73D4E7EFA3C1A09F2EBC1F24C122507AF29256ABA59696168A46A334977475759156AB65ED8A0C4574BEAF97068383E41BECA3DEBE73E4ED3D4B67C46E7AF76FEFD0E9EE5374E29DE3643018080059AD56059E8C33F31932F65BC7FFAC484586A2AC382EA793B66EDA7C5338A3A3A3E4EBEB235F5F1F8D8E8EE6850380780050A56DB05AA5825AA5D45CA3D188402080E6E66668B5DA39CD83D56A45381C66536924348276C711852DE799472279237E9F1FA150088220A07EF7EE794D90D56A85200818098D60D81F50D8CA91D008569594E0EEBBD6B1FBCF7574E0198703274F9FC69EBADD181B1BCB0B27B33F7F7AF55598D6DF83AACD5B50B5790B4CEBEFC199EEEE397114EB4DAFAF977C833E1ABE3044AEE75D4C738C46E3BC5A9B4DA2D128198D4686E37AC145C3FF18A6FE211F9DF7F592F7BCA4C5EFBCF71732144BDA1B0E87F3C60F87C304800C0603D3167916147DE7BBB462999E4ABFBF9E9EF8F96304805A5A5AE8D0C14304808EBEF5565E38727F7C7D7D12DE9DEBE867DB6D54BFAB8E562CD3D38A657A72399D3971B268B0A4C58E671CCCDE767575CDABB5D944ABD5C2EBF5B2B68E438EB42F9DD6602EED53F33C42974230994CB36C9CCD66635A6EB3D914657ABD1E269349B1B28742124E5959191ED9B81163636338D3DD8D15CBF4F8EFE4356C7B741B2E7DF0012A2A2BF3C2D1EBF588C56208052E0200CA859FE00FEE4EB4B51FC6DEA6460080BBB32B278E2CBCECA6F1BCE48AC9DE424D4D0D9BEA37225AAD164EA71300303E3E8E93274EB10D8B4432C7DCB46CCF71BBDD59F3B2646B63341AE138D28E438E36BCFEE61BA8A8ACC4879723701C69C7D2A54BE1EEEC42E8D2A5BC7064697D5652B8DFFFF11576EF47F7DF0F0088C562F8F8CA959C388C60599BBC5E2F23A7BABA9A55124511168B0566B31966B31976BB3D6759474787C25ECA5AEC3DEBCDD05E0E1C3F4DF0672177DE7517DADA0F63747414F5BBEA50F2BDDBF1F6D1A3287B7003AA366F6136742ED1683470B95CB84DB3042FBFFC72D63A9F7C727D4E0C69A3C171E0390E030303928B25088C18511461369B158D445184288AA8AEAE86C562995576E1C205747575312CB7DB8D81810169079826562297637E65B6C54CD65CABD53AAB3C5B9B99F762B118CE7477A3ADFD30AC976C287B700300A0DFE743BFCF87C2C242708BD473E22C52AB515F5787DB162F66F7FA7D3E965FA65F96B33F191A2CBDB0BC435BB97225AB505B5BCBEC4C381C86D7EB855EAFC7F6EDDB99261B8D4684C3611C3B764CE1230360F9C9D8A4F41C701957A0B8B818A228221289283A260FD0CCBCEC838AA20883C1A0D859CDC4F9C5638FA375DF7EACBA7D25AA366FC1879723A8A8AC445BFB61546DDB9617CED8D8185A9A9AB175D366B4EEDB8FD67DFBD1D4D00000D8BD674FCEFE28080607C574CDB427F2C858AD5666CCC3E130AC562B2B93371F8220B0B2CC85846D1B39F633ED8C6FAA540C643E22D7152A84E98D4D3A9F89D3D67E18B61D3B70E5DFFFC23FC361B89C4EEC6D6A44456525EC07F6A364CDEA79716C3B76C0B6638734D09D9DE8EAECC4F54FAE6343D943D852B535677F1426E2F39475EBD7C1506C80C7E381CD669BA5ADD9C8F5783C28321429E200ABD694A0C850A4C0292C2CC4DEA6467C6DF1620C0F0DE15735353784B3B7A9113F7EE0015CBE2C69757171310CC5C573E22835989451AC4C7B226BB3DBEDC6C4C40482C120962F5F0EBBDDCECAE46D726659E6749E8E8FB21F45271A5B1AA1D168E076BB61B158589BCC285B241281C56241474707341A0D7656EF9CF5327B7E5B9F1567D7EE3ABCFEE61B3785B37ACD6A545456A2A2B21286E2E2BC7058B0C73F3C80828202ACBFFB1E4CC62661B55A9926793C9E590B996C32CACBCB7396C9ED6B6B6BD1D1D181259A2538FFF75E4C4D4D612A3E8578228E783C210583920944FF338183F683CC97341A8D301A8DD06AB51045910DFA7C419A6BB16B683BE860419ACF1387057BFA87FA515050007B931D9E631E68B55A44A3518567E072B95830C76432A1B9B9990D80CBE5627533CB0060F9F2E5884422B8EF87F7E188B31DD7A7A6109F41B01C374E2553F0F7FB71ECE8AD11AE6404FB06FBB0685101CE9F3B8FEAA724FFD7E974A226C366DD88B8DD6EB60B3B70F0001EDCF000A6E253988AC79188C7114FCC20384B00FEFF3DE0CE0360473A267329743A1D00C06EB7CF729D16221313136C75D5E974E9407CFA142395422A6D8B297DE474AB0A0F00294A219994CED1F6B7EE6304592C16458C7721E49ACD66D6B6FED7F5E9007B729AE48C2323B6C8D2AD7564C4167700D4D0DC40FEE1010A5E0CD0A33F7D5411510B04020B8A746546D2048B40C18B01F20F0FD0BED67DECFE97284DFFA979BA9A06037E0ADE40C03D1A8D524B4B8B22E0BE66ED1ABAF07E9006837E6A686EF832924BDC4CA7B4B1B901E516016AB51A471C47F0DAABAFDDF091917D7F0B128904FAFB07F0E4E34FE6F31D41C6AE8F63F732779933FFE7C2C9D5467E46BE81A65C7D5A10C6CCD4D8DC2069F2C50075BA5F219D4E97F788E9743A723DEFA2E0C5000D06FDF4D2EF5ECABBEDCC63A299F9CC7BF3E1CCD73E1FAC6C75168A314B8365A979BA1A55DBAAD8518FE8EDC189E327E63CB67F5878182653293BD03C7EFC040ED80F2CE44B9859DAB210CD9D5937D775815FE764D5DE5CFDCCBA93CB55B8EA8E12343637A170A92EE3342233DC0885DF2A7F78323E368667DB9D38D7736EC12F7333A6613E933017FE42072D5F8C390996E5DED27BB1A16C03EE587D07BEA1D1A43F9D9A36304484ABB11886068770FAE4E90513FB5969F0CDDAE0F9D6844F8DE0AFE426361A44F4F5AF68F88C361844DCFF06006DC21432895ADA920000000049454E44AE426082>|png>|1.20cm|0.42cm||>
    2013, Lawrence R. Amlord(<with|font|heiti|\<#989C\>\<#4E16\>\<#654F\>>).>

    Show how to generalize <scm|apply-generic> to handle coercion in the
    general case of multiple arguments. One strategy is to attempt to coerce
    all the arguments to the type of the first argument, then to the type of
    the second argument, and so on. Give an example of a situation where this
    strategy (and likewise the two-argument version given above) is not
    sufficiently general. (Hint: Consider the case where there are some
    suitable mixed-type operations present in the table that will not be
    tried.)

    <\answer>
      \;

      The following <scm|apply-generic> procedure handles coercion in the
      general case of multiple arguments.

      <\scm-code>
        (define (apply-generic op . args)

        \ \ (define (coerce-all type items) \ ;; coerce all the items in a
        list to a type

        \ \ \ \ (if (null? items)

        \ \ \ \ \ \ \ \ '()

        \ \ \ \ \ \ \ \ (let ((type1 (car items))

        \ \ \ \ \ \ \ \ \ \ \ \ \ \ (a1 (car items)))

        \ \ \ \ \ \ \ \ \ \ (let ((t1-\<gtr\>type (get-coercion type1 type)))

        \ \ \ \ \ \ \ \ \ \ \ \ (if (t1-\<gtr\>type a1)

        \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (cons (t1-\<gtr\>type a1)

        \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (coerce-all type (cdr
        items)))

        \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (coerce-all type (cdr items)))))))

        \ \ (define (coerced-succeeded? items) \ ;; determine whether all the
        items in the

        \ \ \ \ (= (length items) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ;; original
        list `args' have been coerced to

        \ \ \ \ \ \ \ (length args))) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ;; the
        same type

        \ \ (let ((type-tags (map type-tag args)))

        \ \ \ \ (let ((proc (get op type-tags)))

        \ \ \ \ \ \ (if proc

        \ \ \ \ \ \ \ \ \ \ (apply proc (map contents args))

        \ \ \ \ \ \ \ \ \ \ (let ((coerced-lists (filter coerced-succeeded?

        \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (map
        (lambda (arg)

        \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (coerce-all
        (type-tag arg) args))

        \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ args))))

        \ \ \ \ \ \ \ \ \ \ \ \ (if (not (null? coerced-lists))

        \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (for-each (lambda (l) (apply-generic
        op . l))

        \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ coerced-lists)

        \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (error "No method for these types"

        \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (list op
        type-tags))))))))
      </scm-code>

      <hspace|3ex>The generalized <scm|apply-generic> procedure performs as
      it originally to be if all the elements in a list have the same type.
      Otherwise, it maps the original list of arguments into a bounch of
      lists in which all the elements were coerced to the type of the first
      element, then to the type of the second argument, and so on, as shown
      in Figure <reference|Exercise_2.82-Figure_1><\float|float|tbh>
        <big-figure|<label|Exercise_2.82-Figure_1><with|gr-mode|<tuple|group-edit|group-ungroup>|gr-frame|<tuple|scale|1cm|<tuple|0.5gw|0.509999gh>>|gr-geometry|<tuple|geometry|1par|0.6par>|gr-grid|<tuple|empty>|gr-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-edit-grid-aspect|<tuple|<tuple|axes|none>|<tuple|1|none>|<tuple|10|none>>|gr-edit-grid|<tuple|empty>|gr-edit-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-auto-crop|true|<graphics||<gr-group|<gr-group|<text-at|<math|T<rsub|1>>|<point|-6.8|-1.7>>|<with|arrow-begin|\<less\>|<line|<point|-6.6|-1.4>|<point|-6.61986704590554|-0.9036115888345>>>|<text-at|<math|C<rsub|1>>|<point|-6.3|-1.7>>|<with|arrow-end|\<gtr\>|<line|<point|-6.21533717290647|-0.90950053446223>|<point|-6.2|-1.4>>>|<gr-group|<cline|<point|-6.79763717290647|-0.70787053446223>|<point|-5.99763717290647|-0.70787053446223>|<point|-5.99763717290647|-1.10787053446223>|<point|-6.79763717290647|-1.10787053446223>>|<line|<point|-6.39763717290647|-0.70787053446223>|<point|-6.39763717290647|-1.10787053446223>>>|<with|arrow-end|\<gtr\>|<line|<point|-6.5987|-0.20163>|<point|-6.6|-0.7>>>|<text-at|<math|T<rsub|1>>|<point|-5.50433267760286|-1.68718199497288>>|<with|arrow-begin|\<less\>|<line|<point|-5.3|-1.4>|<point|-5.30752414340521|-0.88244476782643>>>|<gr-group|<cline|<point|-5.48987469506549|-0.6790935798386>|<point|-4.68987469506549|-0.6790935798386>|<point|-4.68987469506549|-1.0790935798386>|<point|-5.48987469506549|-1.0790935798386>>|<line|<point|-5.08987469506549|-0.6790935798386>|<point|-5.08987469506549|-1.0790935798386>>>|<gr-group|<cline|<point|-6.8|-1.94289029309402e-16>|<point|-6.0|-1.94289029309402e-16>|<point|-6.0|-0.4>|<point|-6.8|-0.4>>|<line|<point|-6.4|-1.94289029309402e-16>|<point|-6.4|-0.4>>>|<with|arrow-begin|\<less\>|<line|<point|-4.9|-1.390993>|<point|-4.88418772324382|-0.88244476782643>>>|<with|arrow-end|\<gtr\>|<line|<point|-6.2177|-0.20163>|<point|-5.5|-0.2>>>|<text-at|<math|C<rsub|2>>|<point|-5.0|-1.7>>|<with|arrow-end|\<gtr\>|<line|<point|-5.26933434316709|-0.19252495965075>|<point|-5.27063434316709|-0.69089495965075>>>|<gr-group|<cline|<point|-5.47063434316709|0.0091050403492499>|<point|-4.67063434316709|0.0091050403492499>|<point|-4.67063434316709|-0.39089495965075>|<point|-5.47063434316709|-0.39089495965075>>|<line|<point|-5.07063434316709|0.0091050403492499>|<point|-5.07063434316709|-0.39089495965075>>>|<with|arrow-end|\<gtr\>|<line|<point|-4.88833434316709|-0.19252495965075>|<point|-4.17063434316709|-0.19089495965075>>>|<text-at|<math|\<cdots\>>|<point|-4.07198372800635|-0.25753075803678>>|<gr-group|<cline|<point|-2.99763717290647|-0.69728053446223>|<point|-2.19763717290647|-0.69728053446223>|<point|-2.19763717290647|-1.09728053446223>|<point|-2.99763717290647|-1.09728053446223>>|<line|<point|-2.59763717290647|-0.69728053446223>|<point|-2.59763717290647|-1.09728053446223>>>|<text-at|<math|\<cdots\>>|<point|-3.69002|-0.26014430384284>>|<with|arrow-begin|\<less\>|<line|<point|-2.8|-1.4>|<point|-2.83100608546104|-0.9036115888345>>>|<text-at|<math|T<rsub|1>>|<point|-3.0|-1.7>>|<gr-group|<cline|<point|-3.0|0.0105899999999999>|<point|-2.2|0.0105899999999999>|<point|-2.2|-0.38941>|<point|-3.0|-0.38941>>|<line|<point|-2.6|0.0105899999999999>|<point|-2.6|-0.38941>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.7987|-0.19104>|<point|-2.8|-0.68941>>>|<text-at|<math|\<cdots\>>|<point|-3.29471844893935|-0.2551016713851>>|<with|arrow-begin|\<less\>|<line|<point|-2.4|-1.4>|<point|-2.42883648630771|-0.9036115888345>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.20603|0.00962999999999992>|<point|-2.60819883582484|-0.39253541341447>>>|<text-at|<math|C<rsub|n>>|<point|-2.48015327290522|-1.69764776438682>>>|<gr-group|<text-at|<math|T<rsub|2>>|<point|-2.62164638179653|-4.03587776160868>>|<with|arrow-begin|\<less\>|<line|<point|-2.42164638179653|-3.73587776160868>|<point|-2.44151342770207|-3.23948935044318>>>|<gr-group|<cline|<point|-2.619283554703|-3.04374829607091>|<point|-1.819283554703|-3.04374829607091>|<point|-1.819283554703|-3.44374829607091>|<point|-2.619283554703|-3.44374829607091>>|<line|<point|-2.219283554703|-3.04374829607091>|<point|-2.219283554703|-3.44374829607091>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.036983554703|-3.24537829607091>|<point|-2.02164638179653|-3.73587776160868>>>|<text-at|<math|C<rsub|1>>|<point|-2.12164638179653|-4.03587776160868>>|<with|arrow-end|\<gtr\>|<line|<point|-2.42034638179653|-2.53750776160868>|<point|-2.42164638179653|-3.03587776160868>>>|<gr-group|<cline|<point|-2.62164638179653|-2.33587776160868>|<point|-1.82164638179653|-2.33587776160868>|<point|-1.82164638179653|-2.73587776160868>|<point|-2.62164638179653|-2.73587776160868>>|<line|<point|-2.22164638179653|-2.33587776160868>|<point|-2.22164638179653|-2.73587776160868>>>|<text-at|<math|T<rsub|2>>|<point|-1.32597905939939|-4.02305975658156>>|<with|arrow-begin|\<less\>|<line|<point|-1.12164638179653|-3.73587776160868>|<point|-1.12917052520174|-3.21832252943511>>>|<gr-group|<cline|<point|-1.31152107686202|-3.01497134144728>|<point|-0.51152107686202|-3.01497134144728>|<point|-0.51152107686202|-3.41497134144728>|<point|-1.31152107686202|-3.41497134144728>>|<line|<point|-0.91152107686202|-3.01497134144728>|<point|-0.91152107686202|-3.41497134144728>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.03934638179653|-2.53750776160868>|<point|-1.32164638179653|-2.53587776160868>>>|<with|arrow-begin|\<less\>|<line|<point|-0.72164638179653|-3.72687076160868>|<point|-0.70583410504035|-3.21832252943511>>>|<with|arrow-end|\<gtr\>|<line|<point|-1.09098072496362|-2.52840272125943>|<point|-1.09228072496362|-3.02677272125943>>>|<text-at|<math|C<rsub|2>>|<point|-0.82164638179653|-4.03587776160868>>|<gr-group|<cline|<point|-1.29228072496362|-2.32677272125943>|<point|-0.49228072496362|-2.32677272125943>|<point|-0.49228072496362|-2.72677272125943>|<point|-1.29228072496362|-2.72677272125943>>|<line|<point|-0.89228072496362|-2.32677272125943>|<point|-0.89228072496362|-2.72677272125943>>>|<with|arrow-end|\<gtr\>|<line|<point|-0.70998072496362|-2.52840272125943>|<point|0.00771927503637991|-2.52677272125943>>>|<text-at|<math|\<cdots\>>|<point|0.10636989019712|-2.59340851964546>>|<text-at|<math|\<cdots\>>|<point|0.48833361820347|-2.59602206545152>>|<gr-group|<cline|<point|1.180716445297|-3.03315829607091>|<point|1.980716445297|-3.03315829607091>|<point|1.980716445297|-3.43315829607091>|<point|1.180716445297|-3.43315829607091>>|<line|<point|1.580716445297|-3.03315829607091>|<point|1.580716445297|-3.43315829607091>>>|<with|arrow-begin|\<less\>|<line|<point|1.37835361820347|-3.73587776160868>|<point|1.34734753274243|-3.23948935044318>>>|<text-at|<math|T<rsub|2>>|<point|1.17835361820347|-4.03587776160868>>|<gr-group|<cline|<point|1.17835361820347|-2.32528776160868>|<point|1.97835361820347|-2.32528776160868>|<point|1.97835361820347|-2.72528776160868>|<point|1.17835361820347|-2.72528776160868>>|<line|<point|1.57835361820347|-2.32528776160868>|<point|1.57835361820347|-2.72528776160868>>>|<with|arrow-end|\<gtr\>|<line|<point|1.37965361820347|-2.52691776160868>|<point|1.37835361820347|-3.02528776160868>>>|<text-at|<math|\<cdots\>>|<point|0.88363516926412|-2.59097943299378>>|<with|arrow-begin|\<less\>|<line|<point|1.77835361820347|-3.73587776160868>|<point|1.74951713189576|-3.23948935044318>>>|<with|arrow-end|\<gtr\>|<line|<point|1.97232361820347|-2.32624776160868>|<point|1.57015478237863|-2.72841317502315>>>|<text-at|<math|C<rsub|n>>|<point|1.69820034529825|-4.0335255259955>>>|<gr-group|<with|magnify|0.275572335862737|<line|<point|-4.69564616793137|0.58191311195425>|<point|-4.55786|0.30634077609151>|<point|-4.42007383206863|0.58191311195425>>>|<gr-group|<line|<point|-4.6|1.4>|<point|-4.6|0.5>>|<line|<point|-4.5|1.4>|<point|-4.5|0.5>>>>|<gr-group|<gr-group|<gr-group|<with|arrow-end|\<gtr\>|arrow-begin|o|<line|<point|-4.77433890329408|2.55688030427305>|<point|-5.03933721391718|1.9298782907792>>>|<gr-group|<cline|<point|-5.06030890329408|2.89530030427305>|<point|-3.86030890329408|2.89530030427305>|<point|-3.86030890329408|2.29530030427305>|<point|-5.06030890329408|2.29530030427305>>|<line|<point|-4.46030890329408|2.89530030427305>|<point|-4.46030890329408|2.29530030427305>>>|<with|arrow-end|\<gtr\>|arrow-begin|o|<line|<point|-4.16050890329408|2.57805030427305>|<point|-3.83933721391718|1.9298782907792>>>>|<text-at|<with|font-shape|small-caps|Type1>|<point|-5.63933721391718|1.6298782907792>>|<with|arrow-end|\<gtr\>|<line|<point|-6.53398928429686|3.59078251091414>|<point|-5.04951713189575|3.58900648233893>>>|<text-at|<with|font-shape|small-caps|Args>|<point|-6.87699073994726|3.69078251091414>>|<with|arrow-end|\<gtr\>|arrow-begin|o|<line|<point|-4.75336721391718|3.5914582907792>|<point|-4.73933721391718|2.9298782907792>>>|<gr-group|<cline|<point|-5.03933721391718|3.9298782907792>|<point|-3.83933721391718|3.9298782907792>|<point|-3.83933721391718|3.3298782907792>|<point|-5.03933721391718|3.3298782907792>>|<line|<point|-4.43933721391718|3.9298782907792>|<point|-4.43933721391718|3.3298782907792>>>|<text-at|<with|font-shape|small-caps|Content1>|<point|-4.33933721391718|1.6298782907792>>>|<with|arrow-end|\<gtr\>|arrow-begin|o|<line|<point|-4.13953721391718|3.6126282907792>|<point|-1.02800965736208|3.63379084534991>>>|<gr-group|<text-at|<with|font-shape|small-caps|Type2>|<point|-1.63933721391718|1.6298782907792>>|<gr-group|<with|arrow-end|\<gtr\>|arrow-begin|o|<line|<point|-0.766140067469239|2.60764429421881>|<point|-1.03113837809234|1.98064228072496>>>|<gr-group|<cline|<point|-1.05211006746924|2.94606429421881>|<point|0.14788993253076|2.94606429421881>|<point|0.14788993253076|2.34606429421881>|<point|-1.05211006746924|2.34606429421881>>|<line|<point|-0.45211006746924|2.94606429421881>|<point|-0.45211006746924|2.34606429421881>>>|<with|arrow-end|\<gtr\>|arrow-begin|o|<line|<point|-0.15231006746924|2.62881429421881>|<point|0.16886162190766|1.98064228072496>>>>|<with|arrow-end|\<gtr\>|arrow-begin|o|<line|<point|-0.73783936631829|3.58388123032147>|<point|-0.72380936631829|2.92230123032147>>>|<gr-group|<cline|<point|-1.02380936631829|3.92230123032147>|<point|0.17619063368171|3.92230123032147>|<point|0.17619063368171|3.32230123032147>|<point|-1.02380936631829|3.32230123032147>>|<line|<point|-0.42380936631829|3.92230123032147>|<point|-0.42380936631829|3.32230123032147>>>|<text-at|<with|font-shape|small-caps|Content2>|<point|-0.23933721391718|1.6298782907792>>|<with|arrow-end|\<gtr\>|arrow-begin|o|<line|<point|-0.12400936631829|3.60505123032147>|<point|1.56066278608282|3.6298782907792>>>>|<gr-group|<text-at|<math|\<cdots\>>|<point|1.72617557844453|3.5298782907792>>|<text-at|<math|\<cdots\>>|<point|2.22617557844453|3.5298782907792>>|<text-at|<math|\<cdots\>>|<point|2.72617557844453|3.5298782907792>>>|<gr-group|<gr-group|<with|arrow-end|\<gtr\>|arrow-begin|o|<line|<point|4.83003815682792|2.5339705278476>|<point|4.56503984620482|1.90696851435375>>>|<gr-group|<cline|<point|4.54406815682792|2.8723905278476>|<point|5.74406815682792|2.8723905278476>|<point|5.74406815682792|2.2723905278476>|<point|4.54406815682792|2.2723905278476>>|<line|<point|5.14406815682792|2.8723905278476>|<point|5.14406815682792|2.2723905278476>>>|<with|arrow-end|\<gtr\>|arrow-begin|o|<line|<point|5.44386815682792|2.5551405278476>|<point|5.76503984620482|1.90696851435375>>>>|<text-at|<with|font-shape|small-caps|Type<math|n>>|<point|3.96066278608282|1.6298782907792>>|<with|arrow-end|\<gtr\>|arrow-begin|o|<line|<point|4.85100984620482|3.56854851435375>|<point|4.86503984620482|2.90696851435375>>>|<with|arrow-end|\<gtr\>|<line|<point|3.16066278608282|3.6298782907792>|<point|4.55053247784099|3.63379084534991>>>|<gr-group|<cline|<point|4.56503984620482|3.90696851435375>|<point|5.76503984620482|3.90696851435375>|<point|5.76503984620482|3.30696851435375>|<point|4.56503984620482|3.30696851435375>>|<line|<point|5.16503984620482|3.90696851435375>|<point|5.16503984620482|3.30696851435375>>>|<line|<point|5.75702557844453|3.8877882907792>|<point|5.16435853915362|3.29512170922079>>|<text-at|<with|font-shape|small-caps|Content<math|n>>|<point|5.26066278608282|1.6298782907792>>>>|<gr-group|<with|magnify|0.275572335862737|<line|<point|-0.60928884553423|-1.71514999163088>|<point|-0.47150267760286|-1.99072232749362>|<point|-0.33371650967149|-1.71514999163088>>>|<line|<point|-0.5|1.4>|<point|-0.51364267760286|-1.79706310358513>>|<line|<point|-0.4|1.4>|<point|-0.41364267760286|-1.79706310358513>>>|<gr-group|<gr-group|<cline|<point|2.15931811218416|-0.77750937557878>|<point|2.95931811218416|-0.77750937557878>|<point|2.95931811218416|-1.17750937557878>|<point|2.15931811218416|-1.17750937557878>>|<line|<point|2.55931811218416|-0.77750937557878>|<point|2.55931811218416|-1.17750937557878>>>|<with|arrow-begin|\<less\>|<line|<point|2.35695528509063|-1.46963884111655>|<point|2.33708823918509|-0.97325042995105>>>|<text-at|<math|T<rsub|n>>|<point|2.15695528509063|-1.76963884111655>>|<with|arrow-end|\<gtr\>|<line|<point|2.74161811218416|-0.97913937557878>|<point|2.75695528509063|-1.46963884111655>>>|<with|arrow-end|\<gtr\>|<line|<point|2.35825528509063|-0.27126884111655>|<point|2.35695528509063|-0.76963884111655>>>|<gr-group|<cline|<point|2.15695528509063|-0.0696388411165502>|<point|2.95695528509063|-0.0696388411165502>|<point|2.95695528509063|-0.46963884111655>|<point|2.15695528509063|-0.46963884111655>>|<line|<point|2.55695528509063|-0.0696388411165502>|<point|2.55695528509063|-0.46963884111655>>>|<text-at|<math|C<rsub|1>>|<point|2.65695528509063|-1.76963884111655>>|<with|arrow-end|\<gtr\>|<line|<point|2.73925528509063|-0.27126884111655>|<point|3.45695528509063|-0.26963884111655>>>|<gr-group|<cline|<point|3.46708059002514|-0.74873242095515>|<point|4.26708059002514|-0.74873242095515>|<point|4.26708059002514|-1.14873242095515>|<point|3.46708059002514|-1.14873242095515>>|<line|<point|3.86708059002514|-0.74873242095515>|<point|3.86708059002514|-1.14873242095515>>>|<with|arrow-begin|\<less\>|<line|<point|3.65695528509063|-1.46963884111655>|<point|3.64943114168542|-0.95208360894298>>>|<text-at|<math|T<rsub|n>>|<point|3.45262260748777|-1.75682083608943>>|<gr-group|<cline|<point|3.48632094192354|-0.0605338007673002>|<point|4.28632094192354|-0.0605338007673002>|<point|4.28632094192354|-0.4605338007673>|<point|3.48632094192354|-0.4605338007673>>|<line|<point|3.88632094192354|-0.0605338007673002>|<point|3.88632094192354|-0.4605338007673>>>|<with|arrow-end|\<gtr\>|<line|<point|3.68762094192354|-0.2621638007673>|<point|3.68632094192354|-0.7605338007673>>>|<with|arrow-begin|\<less\>|<line|<point|4.05695528509063|-1.46063184111655>|<point|4.07276756184681|-0.95208360894298>>>|<text-at|<math|C<rsub|2>>|<point|3.95695528509063|-1.76963884111655>>|<with|arrow-end|\<gtr\>|<line|<point|4.06862094192354|-0.2621638007673>|<point|4.78632094192354|-0.2605338007673>>>|<text-at|<math|\<cdots\>>|<point|4.88497155708428|-0.32716959915333>>|<text-at|<math|\<cdots\>>|<point|5.26693528509063|-0.32978314495939>>|<gr-group|<cline|<point|5.95931811218416|-0.76691937557878>|<point|6.75931811218416|-0.76691937557878>|<point|6.75931811218416|-1.16691937557878>|<point|5.95931811218416|-1.16691937557878>>|<line|<point|6.35931811218416|-0.76691937557878>|<point|6.35931811218416|-1.16691937557878>>>|<with|arrow-begin|\<less\>|<line|<point|6.15695528509063|-1.46963884111655>|<point|6.12594919962959|-0.97325042995105>>>|<gr-group|<cline|<point|5.95695528509063|-0.0590488411165502>|<point|6.75695528509063|-0.0590488411165502>|<point|6.75695528509063|-0.45904884111655>|<point|5.95695528509063|-0.45904884111655>>|<line|<point|6.35695528509063|-0.0590488411165502>|<point|6.35695528509063|-0.45904884111655>>>|<text-at|<math|\<cdots\>>|<point|5.66223683615128|-0.32474051250165>>|<text-at|<math|T<rsub|n>>|<point|5.95695528509063|-1.76963884111655>>|<with|arrow-end|\<gtr\>|<line|<point|6.15825528509063|-0.26067884111655>|<point|6.15695528509063|-0.75904884111655>>>|<with|arrow-end|\<gtr\>|<line|<point|6.75092528509063|-0.0600088411165502>|<point|6.34875644926579|-0.46217425453102>>>|<with|arrow-begin|\<less\>|<line|<point|6.55695528509063|-1.46963884111655>|<point|6.52811879878292|-0.97325042995105>>>|<text-at|<verbatim|><math|C<rsub|n>>|<point|6.47680201218541|-1.76728660550337>>>|<text-at|<scm|(map
        (lambda (arg) (coerce-all ...)) args)>|<point|-2.55453540018521|0.74898789641487>>|<gr-group|<with|magnify|0.275572335862737|<line|<point|5.13304479648191|0.56368318736105>|<point|5.27083096441328|0.28811085149831>|<point|5.40861713234465|0.56368318736105>>>|<gr-group|<line|<point|5.22869096441328|1.3817700754068>|<point|5.22869096441328|0.4817700754068>>|<line|<point|5.32869096441328|1.3817700754068>|<point|5.32869096441328|0.4817700754068>>>>>>>|>
      </float>. It then selects those lists in which all elements in the
      original list of arguments have been successfully coerced to a single
      type. Finishing all the steps above, the <scm|apply-generic> procedure
      now can accomplish its goal by applying itself to each of the filtered
      lists with the designated operation.

      <hspace|3ex>There are several cases where this strategy might fail to
      handle. For example, suppose there is a list which contains a real
      number as the first element and all the subsequent elements of complex
      numbers. We are now required to stretch the magnitude of all the
      complex numbers by the value of the real number. Performing this
      operation using the <scm|apply-generic> procedure above will surely go
      to a wrong answer. Because the <scm|apply-generic> procedure here only
      indexes operations of a single type, rather than the ones of mixed-type
      which the problem belongs to.
    </answer>
  </render-exercise>
</body>

<\initial>
  <\collection>
    <associate|font-base-size|11>
  </collection>
</initial>

<\references>
  <\collection>
    <associate|Exercise_2.82-Figure_1|<tuple|1|?>>
    <associate|auto-1|<tuple|1|2>>
    <associate|footnote-|<tuple|?|?>>
    <associate|footnote-*|<tuple|?|1>>
  </collection>
</references>

<\auxiliary>
  <\collection>
    <\associate|figure>
      <tuple|normal||<pageref|auto-1>>
    </associate>
  </collection>
</auxiliary>