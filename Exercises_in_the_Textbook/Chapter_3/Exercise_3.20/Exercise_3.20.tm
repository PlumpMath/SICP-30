<TeXmacs|1.0.7.19>

<style|generic>

<\body>
  <\render-exercise|Exercise 3.20>
    <render-footnote|*|Creative Commons <image|<tuple|<#89504E470D0A1A0A0000000D49484452000000580000001F080600000063C80AE0000000097048597300000B1300000B1301009A9C1800000A4F6943435050686F746F73686F70204943432070726F66696C65000078DA9D53675453E9163DF7DEF4424B8880944B6F5215082052428B801491262A2109104A8821A1D91551C1114545041BC8A088038E8E808C15512C0C8A0AD807E421A28E83A3888ACAFBE17BA36BD6BCF7E6CDFEB5D73EE7ACF39DB3CF07C0080C9648335135800CA9421E11E083C7C4C6E1E42E40810A2470001008B3642173FD230100F87E3C3C2B22C007BE000178D30B0800C04D9BC0301C87FF0FEA42995C01808401C07491384B08801400407A8E42A600404601809D98265300A0040060CB6362E300502D0060277FE6D300809DF8997B01005B94211501A09100201365884400683B00ACCF568A450058300014664BC43900D82D00304957664800B0B700C0CE100BB200080C00305188852900047B0060C8232378008499001446F2573CF12BAE10E72A00007899B23CB9243945815B082D710757572E1E28CE49172B14366102619A402EC27999193281340FE0F3CC0000A0911511E083F3FD78CE0EAECECE368EB60E5F2DEABF06FF226262E3FEE5CFAB70400000E1747ED1FE2C2FB31A803B06806DFEA225EE04685E0BA075F78B66B20F40B500A0E9DA57F370F87E3C3C45A190B9D9D9E5E4E4D84AC4425B61CA577DFE67C25FC057FD6CF97E3CFCF7F5E0BEE22481325D814704F8E0C2CCF44CA51CCF92098462DCE68F47FCB70BFFFC1DD322C44962B9582A14E35112718E449A8CF332A52289429229C525D2FF64E2DF2CFB033EDF3500B06A3E017B912DA85D6303F64B27105874C0E2F70000F2BB6FC1D4280803806883E1CF77FFEF3FFD47A02500806649927100005E44242E54CAB33FC708000044A0812AB0411BF4C1182CC0061CC105DCC10BFC6036844224C4C24210420A64801C726029AC82422886CDB01D2A602FD4401D34C051688693700E2EC255B80E3D700FFA61089EC128BC81090441C808136121DA8801628A58238E08179985F821C14804128B2420C9881451224B91354831528A542055481DF23D720239875C46BA913BC8003282FC86BC47319481B2513DD40CB543B9A8371A8446A20BD06474319A8F16A09BD072B41A3D8C36A1E7D0AB680FDA8F3E43C730C0E8180733C46C302EC6C342B1382C099363CBB122AC0CABC61AB056AC03BB89F563CFB17704128145C0093604774220611E4148584C584ED848A8201C243411DA093709038451C2272293A84BB426BA11F9C4186232318758482C23D6128F132F107B8843C437241289433227B9900249B1A454D212D246D26E5223E92CA99B34481A2393C9DA646BB20739942C202BC885E49DE4C3E433E41BE421F25B0A9D624071A4F853E22852CA6A4A19E510E534E5066598324155A39A52DDA8A15411358F5A42ADA1B652AF5187A81334759A39CD8316494BA5ADA295D31A681768F769AFE874BA11DD951E4E97D057D2CBE947E897E803F4770C0D861583C7886728199B18071867197718AF984CA619D38B19C754303731EB98E7990F996F55582AB62A7C1591CA0A954A9526951B2A2F54A9AAA6AADEAA0B55F355CB548FA95E537DAE46553353E3A909D496AB55AA9D50EB531B5367A93BA887AA67A86F543FA47E59FD890659C34CC34F43A451A0B15FE3BCC6200B6319B3782C216B0DAB86758135C426B1CDD97C762ABB98FD1DBB8B3DAAA9A13943334A3357B352F394663F07E39871F89C744E09E728A797F37E8ADE14EF29E2291BA6344CB931655C6BAA96979658AB48AB51AB47EBBD36AEEDA79DA6BD45BB59FB810E41C74A275C2747678FCE059DE753D953DDA70AA7164D3D3AF5AE2EAA6BA51BA1BB4477BF6EA7EE989EBE5E809E4C6FA7DE79BDE7FA1C7D2FFD54FD6DFAA7F5470C5806B30C2406DB0CCE183CC535716F3C1D2FC7DBF151435DC34043A561956197E18491B9D13CA3D5468D460F8C69C65CE324E36DC66DC6A326062621264B4DEA4DEE9A524DB9A629A63B4C3B4CC7CDCCCDA2CDD699359B3D31D732E79BE79BD79BDFB7605A785A2CB6A8B6B86549B2E45AA659EEB6BC6E855A3959A558555A5DB346AD9DAD25D6BBADBBA711A7B94E934EAB9ED667C3B0F1B6C9B6A9B719B0E5D806DBAEB66DB67D6167621767B7C5AEC3EE93BD937DBA7D8DFD3D070D87D90EAB1D5A1D7E73B472143A563ADE9ACE9CEE3F7DC5F496E92F6758CF10CFD833E3B613CB29C4699D539BD347671767B97383F3888B894B82CB2E973E2E9B1BC6DDC8BDE44A74F5715DE17AD2F59D9BB39BC2EDA8DBAFEE36EE69EE87DC9FCC349F299E593373D0C3C843E051E5D13F0B9F95306BDFAC7E4F434F8167B5E7232F632F9157ADD7B0B7A577AAF761EF173EF63E729FE33EE33C37DE32DE595FCC37C0B7C8B7CB4FC36F9E5F85DF437F23FF64FF7AFFD100A78025016703898141815B02FBF87A7C21BF8E3F3ADB65F6B2D9ED418CA0B94115418F82AD82E5C1AD2168C8EC90AD21F7E798CE91CE690E85507EE8D6D00761E6618BC37E0C2785878557863F8E7088581AD131973577D1DC4373DF44FA449644DE9B67314F39AF2D4A352A3EAA2E6A3CDA37BA34BA3FC62E6659CCD5589D58496C4B1C392E2AAE366E6CBEDFFCEDF387E29DE20BE37B17982FC85D7079A1CEC2F485A716A92E122C3A96404C884E3894F041102AA8168C25F21377258E0A79C21DC267222FD136D188D8435C2A1E4EF2482A4D7A92EC91BC357924C533A52CE5B98427A990BC4C0D4CDD9B3A9E169A76206D323D3ABD31839291907142AA214D93B667EA67E66676CBAC6585B2FEC56E8BB72F1E9507C96BB390AC05592D0AB642A6E8545A28D72A07B267655766BFCD89CA3996AB9E2BCDEDCCB3CADB90379CEF9FFFED12C212E192B6A5864B572D1D58E6BDAC6A39B23C7179DB0AE315052B865606AC3CB88AB62A6DD54FABED5797AE7EBD267A4D6B815EC1CA82C1B5016BEB0B550AE5857DEBDCD7ED5D4F582F59DFB561FA869D1B3E15898AAE14DB1797157FD828DC78E51B876FCABF99DC94B4A9ABC4B964CF66D266E9E6DE2D9E5B0E96AA97E6970E6E0DD9DAB40DDF56B4EDF5F645DB2F97CD28DBBB83B643B9A3BF3CB8BC65A7C9CECD3B3F54A454F454FA5436EED2DDB561D7F86ED1EE1B7BBCF634ECD5DB5BBCF7FD3EC9BEDB5501554DD566D565FB49FBB3F73FAE89AAE9F896FB6D5DAD4E6D71EDC703D203FD07230EB6D7B9D4D51DD23D54528FD62BEB470EC71FBEFE9DEF772D0D360D558D9CC6E223704479E4E9F709DFF71E0D3ADA768C7BACE107D31F761D671D2F6A429AF29A469B539AFB5B625BBA4FCC3ED1D6EADE7AFC47DB1F0F9C343C59794AF354C969DAE982D39367F2CF8C9D959D7D7E2EF9DC60DBA2B67BE763CEDF6A0F6FEFBA1074E1D245FF8BE73BBC3BCE5CF2B874F2B2DBE51357B8579AAF3A5F6DEA74EA3CFE93D34FC7BB9CBB9AAEB95C6BB9EE7ABDB57B66F7E91B9E37CEDDF4BD79F116FFD6D59E393DDDBDF37A6FF7C5F7F5DF16DD7E7227FDCECBBBD97727EEADBC4FBC5FF440ED41D943DD87D53F5BFEDCD8EFDC7F6AC077A0F3D1DC47F7068583CFFE91F58F0F43058F998FCB860D86EB9E383E3939E23F72FDE9FCA743CF64CF269E17FEA2FECBAE17162F7EF8D5EBD7CED198D1A197F29793BF6D7CA5FDEAC0EB19AFDBC6C2C61EBEC97833315EF456FBEDC177DC771DEFA3DF0F4FE47C207F28FF68F9B1F553D0A7FB93199393FF040398F3FC63332DDB0000000467414D410000B18E7CFB5193000000206348524D00007A25000080830000F9FF000080E9000075300000EA6000003A980000176F925FC54600000A6F4944415478DAEC5A6D6C53D7197EEEB58946273CFFDB2607618436C591561C0AB474B4B1D7AD534BD35C2F295FA1C3665ADB9575494A08DBC897814063421DF7539BD6C46B57B55AA9305F6B173A7C43D0E2C4496C468BF363958D92A8549BE6E0A0A9C41FEF7E5CDF13DFC44E1C68D58EF6958EEFF13DE73CF7DCE7BCE73DEF79CFE58848C371DC557C259FBA1011C701200038DD7D0A3CCF83E779A8542AF0BC0A2A9E07AF4A5F791E1CC783E738701C07709C8C020281528414A5904A4929994C4AD75412C9640AA9549295A528C5EA1391DC1996BF15E491F28D00000E00C9E4AA542A29F1AAE9BC4A2595F1AA34C91C388ECFE4374D4E9AD894446632994E99F9A492E4542AC588CD24FA5622590D4049AE4A0DB5E22AA593C74FC1EBF56260600093B14905D012CD12AC5DBB16E61F9851F6F04348A654E0F9843420491E1CB8F458664C9F14493301E939C449E40EFB03F0BCED41281452D437180C102A04AC5A5392D7CB7D51703800F4D7B3EF42AD563352D56AB594546AF488E7E078C681F1F1F1BC3AA4D3E950FF9B7A9496DE8B44328964328144229D9209241249A6E1999AFCD1F84778BEE3058C8446000026930946A31100100C06218A2200A0C850849DD53BF1AD6F7F33EBF3AF7CF4315E74BDF885C079A47CA344F07B3D67A056A9A789552FC222B51ACD8D2DF01CF3B0065AAD16822040AFD7A3B4B41400D0D3D3834824028FC7838989095657B008A8ABDF85C5B72D462291403C91402211472291509A0C4AE16AF42A7EF9C45388C5621004014EA7137ABD5ED1D9482482DADA5A783C1E68341AB43A5A67BDD4B5D83554EFACF9C2E0C87698CEF69EA5DEBE73D4E7EFA3C1A09F2EBC1F24C122507AF29256ABA59696168A46A334977475759156AB65ED8A0C4574BEAF97068383E41BECA3DEBE73E4ED3D4B67C46E7AF76FEFD0E9EE5374E29DE3643018080059AD56059E8C33F31932F65BC7FFAC484586A2AC382EA793B66EDA7C5338A3A3A3E4EBEB235F5F1F8D8E8EE6850380780050A56DB05AA5825AA5D45CA3D188402080E6E66668B5DA39CD83D56A45381C66536924348276C711852DE799472279237E9F1FA150088220A07EF7EE794D90D56A85200818098D60D81F50D8CA91D008569594E0EEBBD6B1FBCF7574E0198703274F9FC69EBADD181B1BCB0B27B33F7F7AF55598D6DF83AACD5B50B5790B4CEBEFC199EEEE397114EB4DAFAF977C833E1ABE3044AEE75D4C738C46E3BC5A9B4DA2D128198D4686E37AC145C3FF18A6FE211F9DF7F592F7BCA4C5EFBCF71732144BDA1B0E87F3C60F87C304800C0603D3167916147DE7BBB462999E4ABFBF9E9EF8F96304805A5A5AE8D0C14304808EBEF5565E38727F7C7D7D12DE9DEBE867DB6D54BFAB8E562CD3D38A657A72399D3971B268B0A4C58E671CCCDE767575CDABB5D944ABD5C2EBF5B2B68E438EB42F9DD6602EED53F33C42974230994CB36C9CCD66635A6EB3D914657ABD1E269349B1B28742124E5959191ED9B81163636338D3DD8D15CBF4F8EFE4356C7B741B2E7DF0012A2A2BF3C2D1EBF588C56208052E0200CA859FE00FEE4EB4B51FC6DEA6460080BBB32B278E2CBCECA6F1BCE48AC9DE424D4D0D9BEA37225AAD164EA71300303E3E8E93274EB10D8B4432C7DCB46CCF71BBDD59F3B2646B63341AE138D28E438E36BCFEE61BA8A8ACC4879723701C69C7D2A54BE1EEEC42E8D2A5BC7064697D5652B8DFFFF11576EF47F7DF0F0088C562F8F8CA959C388C60599BBC5E2F23A7BABA9A55124511168B0566B31966B31976BB3D6759474787C25ECA5AEC3DEBCDD05E0E1C3F4DF0672177DE7517DADA0F63747414F5BBEA50F2BDDBF1F6D1A3287B7003AA366F6136742ED1683470B95CB84DB3042FBFFC72D63A9F7C727D4E0C69A3C171E0390E030303928B25088C18511461369B158D445184288AA8AEAE86C562995576E1C205747575312CB7DB8D81810169079826562297637E65B6C54CD65CABD53AAB3C5B9B99F762B118CE7477A3ADFD30AC976C287B700300A0DFE743BFCF87C2C242708BD473E22C52AB515F5787DB162F66F7FA7D3E965FA65F96B33F191A2CBDB0BC435BB97225AB505B5BCBEC4C381C86D7EB855EAFC7F6EDDB99261B8D4684C3611C3B764CE1230360F9C9D8A4F41C701957A0B8B818A228221289283A260FD0CCBCEC838AA20883C1A0D859CDC4F9C5638FA375DF7EACBA7D25AA366FC1879723A8A8AC445BFB61546DDB9617CED8D8185A9A9AB175D366B4EEDB8FD67DFBD1D4D00000D8BD674FCEFE28080607C574CDB427F2C858AD5666CCC3E130AC562B2B93371F8220B0B2CC85846D1B39F633ED8C6FAA540C643E22D7152A84E98D4D3A9F89D3D67E18B61D3B70E5DFFFC23FC361B89C4EEC6D6A44456525EC07F6A364CDEA79716C3B76C0B6638734D09D9DE8EAECC4F54FAE6343D943D852B535677F1426E2F39475EBD7C1506C80C7E381CD669BA5ADD9C8F5783C28321429E200ABD694A0C850A4C0292C2CC4DEA6467C6DF1620C0F0DE15735353784B3B7A9113F7EE0015CBE2C69757171310CC5C573E22835989451AC4C7B226BB3DBEDC6C4C40482C120962F5F0EBBDDCECAE46D726659E6749E8E8FB21F45271A5B1AA1D168E076BB61B158589BCC285B241281C56241474707341A0D7656EF9CF5327B7E5B9F1567D7EE3ABCFEE61B3785B37ACD6A545456A2A2B21286E2E2BC7058B0C73F3C80828202ACBFFB1E4CC62661B55A9926793C9E590B996C32CACBCB7396C9ED6B6B6BD1D1D181259A2538FFF75E4C4D4D612A3E8578228E783C210583920944FF338183F683CC97341A8D301A8DD06AB51045910DFA7C419A6BB16B683BE860419ACF1387057BFA87FA515050007B931D9E631E68B55A44A3518567E072B95830C76432A1B9B9990D80CBE5627533CB0060F9F2E5884422B8EF87F7E188B31DD7A7A6109F41B01C374E2553F0F7FB71ECE8AD11AE6404FB06FBB0685101CE9F3B8FEAA724FFD7E974A226C366DD88B8DD6EB60B3B70F0001EDCF000A6E253988AC79188C7114FCC20384B00FEFF3DE0CE0360473A267329743A1D00C06EB7CF729D16221313136C75D5E974E9407CFA142395422A6D8B297DE474AB0A0F00294A219994CED1F6B7EE6304592C16458C7721E49ACD66D6B6FED7F5E9007B729AE48C2323B6C8D2AD7564C4167700D4D0DC40FEE1010A5E0CD0A33F7D5411510B04020B8A746546D2048B40C18B01F20F0FD0BED67DECFE97284DFFA979BA9A06037E0ADE40C03D1A8D524B4B8B22E0BE66ED1ABAF07E9006837E6A686EF832924BDC4CA7B4B1B901E516016AB51A471C47F0DAABAFDDF091917D7F0B128904FAFB07F0E4E34FE6F31D41C6AE8F63F732779933FFE7C2C9D5467E46BE81A65C7D5A10C6CCD4D8DC2069F2C50075BA5F219D4E97F788E9743A723DEFA2E0C5000D06FDF4D2EF5ECABBEDCC63A299F9CC7BF3E1CCD73E1FAC6C75168A314B8365A979BA1A55DBAAD8518FE8EDC189E327E63CB67F5878182653293BD03C7EFC040ED80F2CE44B9859DAB210CD9D5937D775815FE764D5DE5CFDCCBA93CB55B8EA8E12343637A170A92EE3342233DC0885DF2A7F78323E368667DB9D38D7736EC12F7333A6613E933017FE42072D5F8C390996E5DED27BB1A16C03EE587D07BEA1D1A43F9D9A36304484ABB11886068770FAE4E90513FB5969F0CDDAE0F9D6844F8DE0AFE426361A44F4F5AF68F88C361844DCFF06006DC21432895ADA920000000049454E44AE426082>|png>|1.20cm|0.42cm||>
    2013, Lawrence X. Amlord (<with|font|heiti|\<#989C\>\<#4E16\>\<#654F\>>,
    aka <with|font|heiti|\<#989C\> \<#5E8F\>>).>

    Draw environment diagrams to illustrate the evaluation of the sequence of
    expressions

    <\scm-code>
      (define x (cons 1 2))

      (define z (cons x x))

      (set-car! (cdr z) 17)

      (car x)

      <with|prog-font-shape|italic|<with|prog-font-shape|italic|17>>
    </scm-code>

    using the procedure implementation of pairs given above. (Compare
    exercise 3.11.)

    <\answer>
      \;

      Figure <reference|Exercise_3.20-Figure_1><\float|float|tbh>
        <big-figure|<label|Exercise_3.20-Figure_1><with|gr-mode|<tuple|edit|line>|gr-frame|<tuple|scale|1cm|<tuple|0.529997gw|0.569991gh>>|gr-geometry|<tuple|geometry|1par|0.6par>|gr-grid|<tuple|empty>|gr-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-edit-grid-aspect|<tuple|<tuple|axes|none>|<tuple|1|none>|<tuple|10|none>>|gr-edit-grid|<tuple|empty>|gr-edit-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-arrow-end|\<gtr\>|gr-auto-crop|true|<graphics||<cline|<point|-6|3>|<point|6.0|3.0>|<point|6.0|1.0>|<point|-6.0|1.0>>|<with|arrow-end|\<gtr\>|<line|<point|-6.5|2>|<point|-6.0|2.0>>>|<gr-group|<text-at|<scm|env>|<point|-7.1|2.1>>|<text-at|<scm|global>|<point|-7.1|2.4>>>|<carc|<point|-4.5|-0.5>|<point|-3.9|-0.5>|<point|-4.2|-0.2>>|<carc|<point|-5.1|-0.5>|<point|-4.5|-0.5>|<point|-4.8|-0.2>>|<point|-4.2|-0.5>|<point|-4.8|-0.5>|<text-at|<scm|set-car!:>|<point|-5.9|2.66776>>|<text-at|<scm|cons:>|<point|-5.9|1.1>>|<text-at|<scm|set-cdr!:
        ...>|<point|-5.9|2.26776>>|<text-at|<scm|cdr:
        ...>|<point|-5.9|1.5>>|<text-at|<scm|car:>|<point|-5.9|1.9>>|<point|0.3|-0.5>|<gr-group|<text-at|<scm|parameters:
        z>|<point|-0.9|-1.6>>|<text-at|<scm|body: (z
        'car)>|<point|-0.9|-2.0>>>|<carc|<point|-5.55111512312578e-17|-0.5>|<point|0.6|-0.5>|<point|0.3|-0.2>>|<gr-group|<text-at|<scm|dispatch>|<point|-6.1|-3.2>>|<text-at|<scm|parameters:
        x, y>|<point|-7.1|-1.6>>|<text-at|<scm|(define (set-y! ...)
        ...)>|<point|-6.1|-2.4>>|<text-at|<scm|body: (define (set-x! ...)
        ...)>|<point|-7.1|-2.0>>|<text-at|<scm|(define (dispatch ...)
        ...)>|<point|-6.1|-2.8>>>|<point|3.5|-0.5>|<carc|<point|2.6|-0.5>|<point|3.2|-0.5>|<point|2.9|-0.2>>|<gr-group|<text-at|<scm|z)>|<point|3.4|-2.8>>|<text-at|<scm|new-value)>|<point|3.57596|-2.4>>|<text-at|<scm|body:
        ((z 'set-car!)>|<point|2.4|-2.0>>|<text-at|<scm|parameters: z,
        new-value>|<point|2.4|-1.6>>>|<carc|<point|3.2|-0.5>|<point|3.8|-0.5>|<point|3.5|-0.2>>|<point|-0.3|-0.5>|<carc|<point|-0.6|-0.5>|<point|-5.55111512312578e-17|-0.5>|<point|-0.3|-0.2>>|<point|2.9|-0.5>|<with|arrow-begin|\<less\>|<line|<point|-4.5|-0.2>|<point|-4.5|1.2>|<point|-5.08018587114698|1.19865392247652>>>|<with|arrow-end|\<gtr\>|<line|<point|-5.1247|1.96833>|<point|0.0|2.0>|<point|0.0|-0.2>>>|<with|arrow-end|\<gtr\>|<line|<point|-4.29151|2.76473>|<point|3.2|2.8>|<point|3.2|-0.2>>>|<with|arrow-end|\<gtr\>|<line|<point|-4.2|-0.5>|<point|-3.4|-0.5>|<point|-3.4|1.0>>>|<with|arrow-end|\<gtr\>|<line|<point|0.3|-0.5>|<point|1.2|-0.5>|<point|1.2|1.0>>>|<with|arrow-end|\<gtr\>|<line|<point|3.5|-0.5>|<point|4.3|-0.5>|<point|4.3|1.0>>>|<with|arrow-end|\<gtr\>|<line|<point|-4.8|-0.5>|<point|-4.79185408122768|-1.40486506151607>>>|<with|arrow-end|\<gtr\>|<line|<point|-0.3|-0.5>|<point|-0.304488027516867|-1.32019777748379>>>|<with|arrow-end|\<gtr\>|<line|<point|2.9|-0.5>|<point|2.89170194470168|-1.32019777748379>>>>>|Environment
        structure produced by evaluting <scm|(define (cons x y) ...)> etc. in
        the global environment.>
      </float> shows the environment structure in the evaluation of the
      following definitions:

      <\scm-code>
        (define (cons x y)

        \ \ (define (set-x! v) (set! x v))

        \ \ (define (set-y! v) (set! y v))

        \ \ (define (dispatch m)

        \ \ \ \ (cond ((eq? m 'car) x)

        \ \ \ \ \ \ \ \ \ \ ((eq? m 'cdr) y)

        \ \ \ \ \ \ \ \ \ \ ((eq? m 'set-car!) set-x!)

        \ \ \ \ \ \ \ \ \ \ ((eq? m 'set-cdr!) set-y!)

        \ \ \ \ \ \ \ \ \ \ (else

        \ \ \ \ \ \ \ \ \ \ \ \ (error "Undifined operations -- CONS" m))))

        \ \ dispatch)

        \;

        (define (car z) (z 'car))

        \;

        (define (cdr z) (z 'cdr))

        \;

        (define (set-car! z new-value)

        \ \ ((z 'set-car!) new-value)

        \ \ z)

        \;

        (define (set-cdr! z new-value)

        \ \ ((z 'set-cdr!) new-value)

        \ \ z)
      </scm-code>

      As we know, evaluting the expression:

      <\scm-code>
        (define x (cons 1 2))
      </scm-code>

      would set up a new environment, namely E1, subordinate to the global
      environment, in which the formal parameters of procedure object
      <scm|cons>: <scm|x> and <scm|y> were bound to <scm|1> and <scm|2>
      respectively. The body of <scm|cons> was then evaluated in E1. Since
      the first expression in the body of <scm|cons> is\ 

      <\scm-code>
        (define (set-x! v) (set! x v))
      </scm-code>

      <hspace|3ex>Evaluating this expression defined the procedure object
      <scm|set-x!> in the environment E1. Similarly, <scm|set-y!> and
      <scm|dispatch> were defined as procedures in E1. Besides, defining the
      symbol <scm|x> created a binding in the global environment and
      associated it with the internal procedure <scm|dispatch> in E1. This
      process can be illustrated in a more intuitive way, as figure
      <reference|Exercise_3.20-Figure_2><\float|float|tbh>
        <big-figure|<label|Exercise_3.20-Figure_2><with|gr-mode|<tuple|edit|line>|gr-frame|<tuple|scale|1cm|<tuple|0.519998gw|293868tmpt>>|gr-geometry|<tuple|geometry|1par|0.6par>|gr-grid|<tuple|empty>|gr-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-edit-grid-aspect|<tuple|<tuple|axes|none>|<tuple|1|none>|<tuple|10|none>>|gr-edit-grid|<tuple|empty>|gr-edit-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-arrow-end|\<gtr\>|gr-auto-crop|true|<graphics||<gr-group|<text-at|<scm|dispatch>|<point|2.1|-3.0>>|<text-at|<scm|parameters:
        x, y>|<point|1.1|-1.4>>|<text-at|<scm|(define (set-y! ...)
        ...)>|<point|2.1|-2.2>>|<text-at|<scm|body: (define (set-x! ...)
        ...)>|<point|1.1|-1.8>>|<text-at|<scm|(define (dispatch ...)
        ...)>|<point|2.1|-2.6>>>|<cline|<point|-6.0|3.3>|<point|6.0|3.3>|<point|6.0|1.3>|<point|-6.0|1.3>>|<with|arrow-end|\<gtr\>|<line|<point|-6.5|2.3>|<point|-6.0|2.3>>>|<gr-group|<text-at|<scm|env>|<point|-7.1|2.4>>|<text-at|<scm|global>|<point|-7.1|2.7>>>|<text-at|<scm|car,
        cdr, set-car!, set-cdr!: ...>|<point|-5.9|2.26776>>|<text-at|<scm|cons:>|<point|-5.9|2.96776>>|<carc|<point|2.6|-0.200000000000002>|<point|3.2|-0.200000000000002>|<point|2.9|0.0999999999999982>>|<with|arrow-end|\<gtr\>|<line|<point|2.9|-0.200000000000002>|<point|2.89170194470168|-1.02019777748379>>>|<point|2.9|-0.200000000000002>|<carc|<point|3.2|-0.200000000000002>|<point|3.8|-0.200000000000002>|<point|3.5|0.0999999999999982>>|<with|arrow-end|\<gtr\>|<line|<point|3.5|-0.200000000000002>|<point|4.3|-0.200000000000002>|<point|4.3|1.3>>>|<point|3.5|-0.200000000000002>|<with|arrow-end|\<gtr\>|<line|<point|-5.06702275433258|3.06445958460114>|<point|3.2|3.1>|<point|3.2|0.0999999999999982>>>|<text-at|<scm|x:>|<point|-5.91475486836883|1.56905013890726>>|<carc|<point|-1.0|-2.6>|<point|-0.399999999999998|-2.6>|<point|-0.699999999999999|-2.3>>|<text-at|<scm|y:
        2>|<point|-3.6|-0.5>>|<with|arrow-end|\<gtr\>|<line|<point|-2.3047|-0.803>|<point|-1.0|-0.8>|<point|-1.0|-2.3>>>|<text-at|<scm|set-y!:
        ...>|<point|-3.6|-1.3>>|<text-at|<scm|x:
        1>|<point|-3.6|-0.1>>|<text-at|<scm|body: (set! x
        v)>|<point|-2.6|-4.2>>|<text-at|<scm|dispatch:
        ...>|<point|-3.6|-1.7>>|<text-at|<scm|parameters:
        v>|<point|-2.6|-3.8>>|<point|-0.699999999999999|-2.6>|<with|arrow-end|\<gtr\>|<line|<point|-0.699999999999999|-2.6>|<point|1.23512311489549e-15|-2.6>|<point|1.23512311489549e-15|-1.6>|<point|-0.599999999999998|-1.6>>>|<carc|<point|-1.6|-2.6>|<point|-1.0|-2.6>|<point|-1.3|-2.3>>|<text-at|<scm|set-x!:>|<point|-3.57992|-0.9>>|<with|arrow-end|\<gtr\>|<line|<point|-1.3|-2.6>|<point|-1.30829805529832|-3.42019777748379>>>|<point|-1.3|-2.6>|<cline|<point|-4.0|0.2651>|<point|-0.599999999999998|0.2651>|<point|-0.599999999999998|-1.9349>|<point|-4.0|-1.9349>>|<with|arrow-end|\<gtr\>|<line|<point|-4.5|0>|<point|-4.0|0.0>>>|<text-at|<scm|E1>|<point|-4.7|0.0999999999999999>>|<with|arrow-end|\<gtr\>|<line|<point|-5.60019513163117|1.68317568461437>|<point|-5.0|1.7>|<point|-5.0|-1.6>|<point|-3.71118864929223|-1.61557745733563>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.3|0.2651>|<point|-2.3|1.3>>>>>|Environments
        created in evaluating <scm|(define x (cons 1 2))>>
      </float> did.

      <hspace|3ex>Then, the interpreter proceeded to evaluate the subsequent
      expression

      <\scm-code>
        (define z (cons x x))
      </scm-code>

      This generated almost the same process as the former one and constructs
      another environment, namely E2. Notice that both of <scm|x> and <scm|y>
      in E2 are bound to the value of <scm|x> in the global environment,
      which is associated to the internal procedure <scm|dispatch> of E1.
      Figure <reference|Exercise_3.20-Figure_3><\float|float|tbh>
        <big-figure|<label|Exercise_3.20-Figure_3><with|gr-mode|<tuple|edit|line>|gr-frame|<tuple|scale|1cm|<tuple|0.509999gw|261216tmpt>>|gr-geometry|<tuple|geometry|1par|0.6par>|gr-grid|<tuple|empty>|gr-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-edit-grid-aspect|<tuple|<tuple|axes|none>|<tuple|1|none>|<tuple|10|none>>|gr-edit-grid|<tuple|empty>|gr-edit-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-arrow-end|o|gr-auto-crop|true|<graphics||<with|arrow-end|\<gtr\>|<line|<point|-5.56574513163117|1.98317568461437>|<point|-4.96555|2.0>|<point|-4.96555|-1.3>|<point|-3.67673864929223|-1.31557745733563>>>|<with|arrow-end|\<gtr\>|<line|<point|-4.46555|0.300000000000001>|<point|-3.96555|0.300000000000001>>>|<text-at|<scm|E2>|<point|-4.66555|0.400000000000001>>|<cline|<point|-5.96555|3.6>|<point|6.03445|3.6>|<point|6.03445|1.6>|<point|-5.96555|1.6>>|<carc|<point|-1.56555|-2.3>|<point|-0.96555|-2.3>|<point|-1.26555|-2.0>>|<with|arrow-end|\<gtr\>|<line|<point|-1.26555|-2.3>|<point|-1.27384805529832|-3.1201977774838>>>|<gr-group|<cline|<point|-3.96555|0.5651>|<point|-0.565549999999999|0.5651>|<point|-0.565549999999999|-1.6349>|<point|-3.96555|-1.6349>>|<text-at|<scm|y:>|<point|-3.56555|-0.199999999999999>>|<text-at|<scm|set-x!:>|<point|-3.54547|-0.6>>|<text-at|<scm|x:>|<point|-3.56555|0.200000000000001>>|<text-at|<scm|set-y!:
        ...>|<point|-3.56555|-1.0>>|<text-at|<scm|dispatch:
        ...>|<point|-3.56555|-1.4>>|<with|arrow-end|\<gtr\>|<line|<point|-2.27025|-0.503>|<point|-0.96555|-0.5>|<point|-0.96555|-2.0>>>>|<point|-1.26555|-2.3>|<text-at|<scm|z:>|<point|-5.88030486836883|1.86905013890726>>|<carc|<point|-0.96555|-2.3>|<point|-0.36555|-2.3>|<point|-0.665549999999999|-2.0>>|<with|arrow-end|\<gtr\>|<line|<point|-2.26555|0.5651>|<point|-2.26555|1.6>>>|<with|arrow-end|\<gtr\>|<line|<point|-0.665549999999999|-2.3>|<point|0.0344500000000002|-2.3>|<point|0.0344500000000002|-1.3>|<point|-0.565549999999999|-1.3>>>|<point|-0.665549999999999|-2.3>|<with|arrow-end|\<gtr\>|<line|<point|-6.46555|2.6>|<point|-5.96555|2.6>>>|<text-at|<scm|parameters:
        v>|<point|-2.56555|-3.5>>|<text-at|<scm|body: (set! x
        v)>|<point|-2.56555|-3.9>>|<text-at|<scm|x:>|<point|-5.86555|3.26776>>|<text-at|<scm|cons,
        car, cdr, set-car!, set-cdr!: ...>|<point|-5.86555|2.56776>>|<gr-group|<text-at|<scm|env>|<point|-7.06555|2.7>>|<text-at|<scm|global>|<point|-7.06555|3.0>>>|<with|arrow-end|\<gtr\>|<line|<point|4.03445|0.5651>|<point|4.03445|1.6>>>|<text-at|<scm|dispatch:
        ...>|<point|2.73445|-1.4>>|<text-at|<scm|x:
        1>|<point|2.73445|0.200000000000001>>|<text-at|<scm|set-y!:
        ...>|<point|2.73445|-1.0>>|<text-at|<scm|set-x!:>|<point|2.75453|-0.6>>|<text-at|<scm|y:
        2>|<point|2.73445|-0.199999999999999>>|<text-at|<scm|E1>|<point|1.63445|0.400000000000001>>|<with|arrow-end|\<gtr\>|<line|<point|1.83445|0.300000000000001>|<point|2.33445|0.300000000000001>>>|<cline|<point|2.33445|0.5651>|<point|5.73445|0.5651>|<point|5.73445|-1.6349>|<point|2.33445|-1.6349>>|<with|arrow-end|\<gtr\>|<line|<point|-5.5406965207038|3.39967257573753>|<point|1.3|3.4>|<point|1.33445|-1.3>|<point|2.62326135070777|-1.31557745733563>>>|<text-at|<scm|body:
        (set! x v)>|<point|3.71685508003704|-3.88514023018918>>|<text-at|<scm|parameters:
        v>|<point|3.71685508003704|-3.48514023018918>>|<with|arrow-end|\<gtr\>|<line|<point|5.01685508003704|-2.28514023018918>|<point|5.00855702473872|-3.10533800767298>>>|<carc|<point|5.31685508003704|-2.28514023018918>|<point|5.91685508003704|-2.28514023018918>|<point|5.61685508003704|-1.98514023018918>>|<point|5.01685508003704|-2.28514023018918>|<carc|<point|4.71685508003704|-2.28514023018918>|<point|5.31685508003704|-2.28514023018918>|<point|5.01685508003704|-1.98514023018918>>|<with|arrow-end|\<gtr\>|<line|<point|5.61685508003704|-2.28514023018918>|<point|6.31685508003704|-2.28514023018918>|<point|6.31685508003704|-1.28514023018918>|<point|5.71685508003704|-1.28514023018918>>>|<with|arrow-end|\<gtr\>|<line|<point|4.01215508003704|-0.48814023018918>|<point|5.31685508003704|-0.48514023018918>|<point|5.31685508003704|-1.98514023018918>>>|<point|5.6|-2.3>|<with|arrow-end|o|<line|<point|-3.21235|0.267099>|<point|1.32272234042553|0.3>>>|<with|arrow-end|o|<line|<point|-3.21235|-0.135071>|<point|1.32565425531915|-0.1>>>>>|Environments
        established during the evaluation of <scm|(define z (cons x x))>>
      </float> shows the environments established during this evaluation.

      <hspace|3ex>When the interpreter tried to evaluate the expression\ 

      <\scm-code>
        (set-car! (cdr z) 17)
      </scm-code>

      It first evaluated the operator subexpression. This established a new
      environment E3, subordinate to the global environment, in which <scm|z>
      and <scm|new-value>, the formal parameters of <scm|set-car!> were bound
      to the value of the operand subexpression, that is, the value of
      <scm|(cdr z)> and <scm|17> respectively.

      <hspace|3ex>To obtain the value of <scm|(cdr z)>, the interpreter then
      set up a new environment E4, subordinate to the global environment, in
      which <scm|z>, the formal parameter of the procedure object <scm|cdr>,
      was bound to another <scm|z> which has been settled in the global
      environment and associated to the internal procedure object
      <scm|dispatch> in E2.

      <hspace|3ex>This in effect set up another environment subordinate to
      E2, namely E5 in which, <scm|m> the formal parameter of <scm|dispatch>
      was bound to <scm|'cdr> and evaluated the body of <scm|dispatch>. All
      these trivial steps can be illustrated in a more intuitive way, as
      figure <reference|Exercise_3.20-Figure_4><\float|float|tbh>
        <big-figure|<label|Exercise_3.20-Figure_4><with|gr-mode|<tuple|edit|line>|gr-frame|<tuple|scale|1cm|<tuple|0.519998gw|293868tmpt>>|gr-geometry|<tuple|geometry|1par|0.6par>|gr-grid|<tuple|empty>|gr-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-edit-grid-aspect|<tuple|<tuple|axes|none>|<tuple|1|none>|<tuple|10|none>>|gr-edit-grid|<tuple|empty>|gr-edit-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-arrow-begin|o|gr-auto-crop|true|<graphics||<cline|<point|-5.96555|3.6>|<point|6.03445|3.6>|<point|6.03445|1.6>|<point|-5.96555|1.6>>|<cline|<point|-2.26555|0.9651>|<point|1.13445|0.9651>|<point|1.13445|-1.2349>|<point|-2.26555|-1.2349>>|<text-at|<scm|E2>|<point|-2.76555|0.8>>|<text-at|<scm|z:>|<point|-5.88030486836883|1.86905013890726>>|<text-at|<scm|(else
        (error ...))>|<point|-1.15682169643336|-4.4708>>|<with|arrow-end|\<gtr\>|<line|<point|-6.46555|2.6>|<point|-5.96555|2.6>>>|<gr-group|<text-at|<scm|env>|<point|-7.06555|2.7>>|<text-at|<scm|global>|<point|-7.06555|3.0>>>|<text-at|<scm|x:>|<point|-5.86555|3.26776>>|<text-at|<scm|cons,
        car, cdr, set-car!, set-cdr!: ...>|<point|-5.86555|2.56776>>|<text-at|<scm|E5>|<point|-2.15682169643336|-1.9>>|<cline|<point|-6.3|-2.0349>|<point|-3.4|-2.0349>|<point|-3.4|-3.0349>|<point|-6.3|-3.0349>>|<text-at|<scm|z:
        (cdr z)>|<point|-5.9|-2.4349>>|<text-at|<scm|z:>|<point|-5.0|0.1>>|<cline|<point|-5.2|0.6>|<point|-4.0|0.6>|<point|-4.0|-0.2>|<point|-5.2|-0.2>>|<text-at|<scm|E4>|<point|-5.80138415400449|0.377468>>|<text-at|<scm|new-value:
        17>|<point|-5.9|-2.79656>>|<with|arrow-end|\<gtr\>|<line|<point|-6.8|-2.2349>|<point|-6.3|-2.2349>>>|<text-at|<scm|z)>|<point|-6.939493|-3.80104>>|<text-at|<scm|E3>|<point|-6.8|-2.1349>>|<with|arrow-end|\<gtr\>|<line|<point|-1.95682169643336|-2.0>|<point|-1.45682169643336|-2.0>>>|<gr-group|<cline|<point|-1.45682169643336|-1.8>|<point|0.34317830356664|-1.8>|<point|0.34317830356664|-2.5>|<point|-1.45682169643336|-2.5>>|<text-at|<scm|m:
        'cdr>|<point|-1.15682169643336|-2.2>>>|<text-at|<scm|((eq? m 'cdr)
        y)>|<point|-1.15682169643336|-3.2708>>|<text-at|<scm|((eq? m
        'set-car!) set-x!)>|<point|-1.15682169643336|-3.6708>>|<text-at|<scm|x:>|<point|-1.86555|0.600000000000002>>|<text-at|<scm|dispatch:
        ...>|<point|-1.86555|-1.0>>|<text-at|<scm|y:>|<point|-1.86555|0.200000000000001>>|<text-at|<scm|set-y!:
        ...>|<point|-1.86555|-0.6>>|<text-at|<scm|set-x!:>|<point|-1.84547|-0.2>>|<with|arrow-end|\<gtr\>|<line|<point|-0.59451|-1.8156>|<point|-0.6|-1.2349>>>|<text-at|<scm|((eq?
        m 'set-cdr!) set-y!)>|<point|-1.15682169643336|-4.0708>>|<with|arrow-end|\<gtr\>|<line|<point|-2.76555|0.7>|<point|-2.26555|0.7>>>|<text-at|<scm|(cond
        ((eq? m 'car) x)>|<point|-2.15682169643336|-2.8708>>|<text-at|<scm|((z
        'set-car!) new-value)>|<point|-6.939493|-3.40104>>|<with|arrow-end|\<gtr\>|<line|<point|-5.55786148961503|1.98858976055034>|<point|-3.0|2.0>|<point|-3.0|-0.9>|<point|-1.90684945098558|-0.92114036248181>>>|<with|arrow-end|\<gtr\>|<line|<point|-5.70138415400449|0.277468>|<point|-5.20138415400449|0.277468>>>|<text-at|<scm|(z
        'cdr)>|<point|-5.30138415400449|-0.522532>>|<with|arrow-end|\<gtr\>|<line|<point|-4.6|0.6>|<point|-4.6|1.6>>>|<with|arrow-end|o|<line|<point|-4.55798|0.168342>|<point|-3.0|0.2>>>|<with|arrow-end|\<gtr\>|<line|<point|-0.5|0.9651>|<point|-0.5|1.6>>>|<with|arrow-end|\<gtr\>|<line|<point|4.4|0.9651>|<point|4.4|1.6>>>|<text-at|<scm|E1>|<point|2.13445|0.8>>|<with|arrow-end|\<gtr\>|<line|<point|2.13445|0.7>|<point|2.63445|0.7>>>|<text-at|<scm|x:
        1>|<point|3.03445|0.600000000000002>>|<text-at|<scm|dispatch:
        ...>|<point|3.03445|-1.0>>|<text-at|<scm|y:
        2>|<point|3.03445|0.200000000000001>>|<text-at|<scm|set-y!:
        ...>|<point|3.03445|-0.6>>|<text-at|<scm|set-x!:>|<point|3.05453|-0.2>>|<cline|<point|2.63445|0.9651>|<point|6.03445|0.9651>|<point|6.03445|-1.2349>|<point|2.63445|-1.2349>>|<with|arrow-end|\<gtr\>|<line|<point|-5.42353|3.33609>|<point|1.5|3.3>|<point|1.5|-1.0>|<point|3.03444569387485|-1.0>>>|<with|arrow-begin|o|<line|<point|1.5|0.3>|<point|-1.53732305860564|0.295244079904749>>>|<with|arrow-begin|o|<line|<point|1.5|0.7>|<point|-1.53732305860564|0.697413679058076>>>|<with|arrow-end|\<gtr\>|<line|<point|-6.0|-2.0>|<point|-6.0|1.0>|<point|-5.5|1.0>|<point|-5.5|1.6>>>>>|Environments
        in the evaluation of <scm|(cdr z)> in terms of E3.>
      </float> did.

      <hspace|3ex>By doing these, the interpreter gained the value of
      <scm|(cdr z)>, one of the operand subexpressions in <scm|(set-car! (car
      z) 17)>, that is, a binding associated to the internal procedure
      <scm|dispatch> of E1<scm|>. Figure <reference|Exercise_3.20-Figure_5><\float|float|tbh>
        <big-figure|<label|Exercise_3.20-Figure_5><with|gr-mode|<tuple|group-edit|move>|gr-frame|<tuple|scale|1cm|<tuple|0.519998gw|315636tmpt>>|gr-geometry|<tuple|geometry|1par|0.6par>|gr-grid|<tuple|empty>|gr-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-edit-grid-aspect|<tuple|<tuple|axes|none>|<tuple|1|none>|<tuple|10|none>>|gr-edit-grid|<tuple|empty>|gr-edit-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-arrow-end|o|gr-auto-crop|true|<graphics||<text-at|<scm|dispatch:
        ...>|<point|-1.86555|-1.6>>|<with|arrow-end|\<gtr\>|<line|<point|-0.5|0.3651>|<point|-0.5|1.0>>>|<with|arrow-begin|o|<line|<point|1.8|0.1>|<point|-1.53732305860564|0.097413679058076>>>|<text-at|<scm|set-y!:
        ...>|<point|-1.86555|-1.2>>|<text-at|<scm|set-x!:>|<point|-1.84547|-0.8>>|<text-at|<scm|x:>|<point|-5.86555|2.66776>>|<gr-group|<text-at|<scm|env>|<point|-7.06555|2.1>>|<text-at|<scm|global>|<point|-7.06555|2.4>>>|<text-at|<scm|((z
        'set-car!) new-value)>|<point|-6.039493|-4.40104>>|<with|arrow-end|\<gtr\>|<line|<point|2.13445|0.1>|<point|2.63445|0.1>>>|<text-at|<scm|x:
        1>|<point|3.03445|1.97064586870965e-15>>|<with|arrow-end|\<gtr\>|<line|<point|4.4|0.3651>|<point|4.4|1.0>>>|<text-at|<scm|set-y!:
        ...>|<point|3.03445|-1.2>>|<text-at|<scm|dispatch:
        ...>|<point|3.03445|-1.6>>|<text-at|<scm|set-x!:>|<point|3.05453|-0.8>>|<text-at|<scm|y:>|<point|-1.86555|-0.399999999999999>>|<cline|<point|-5.96555|3.0>|<point|6.03445|3.0>|<point|6.03445|1.0>|<point|-5.96555|1.0>>|<text-at|<scm|x:>|<point|-1.86555|1.97064586870965e-15>>|<text-at|<scm|z:>|<point|-5.88030486836883|1.26905013890726>>|<with|arrow-end|\<gtr\>|<line|<point|-6.46555|2.0>|<point|-5.96555|2.0>>>|<with|arrow-end|\<gtr\>|<line|<point|-5.42353|2.73609>|<point|1.8|2.7>|<point|1.8|-1.6>|<point|3.03444569387485|-1.6>>>|<text-at|<scm|cons,
        car, cdr, set-car!, set-cdr!: ...>|<point|-5.86555|1.96776>>|<cline|<point|2.63445|0.3651>|<point|6.03445|0.3651>|<point|6.03445|-1.8349>|<point|2.63445|-1.8349>>|<cline|<point|-2.26555|0.3651>|<point|1.13445|0.3651>|<point|1.13445|-1.8349>|<point|-2.26555|-1.8349>>|<cline|<point|-5.4|-3.0349>|<point|-2.5|-3.0349>|<point|-2.5|-4.0349>|<point|-5.4|-4.0349>>|<with|arrow-end|\<gtr\>|<line|<point|-4.01268|-3.03666>|<point|-4.0|1.0>>>|<text-at|<scm|new-value:
        17>|<point|-5.0|-3.79656>>|<text-at|<scm|z:>|<point|-5.0|-3.4349>>|<text-at|<scm|z)>|<point|-6.039493|-4.80104>>|<with|arrow-end|o|<line|<point|-4.69002182828416|-3.31183357586982>|<point|1.5|-3.3>|<point|1.5|-0.8>|<point|1.8|-0.8>>>|<with|arrow-end|\<gtr\>|<line|<point|-5.9|-3.2349>|<point|-5.4|-3.2349>>>|<text-at|<scm|E3>|<point|-5.9|-3.1349>>|<with|arrow-end|\<gtr\>|<line|<point|-5.55786148961503|1.38858976055034>|<point|-3.0|1.4>|<point|-3.0|-1.5>|<point|-1.90684945098558|-1.52114036248181>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.76555|0.1>|<point|-2.26555|0.1>>>|<text-at|<scm|E2>|<point|-2.76555|0.2>>|<with|arrow-begin|o|<line|<point|1.8|-0.3>|<point|-1.53732305860564|-0.304755920095251>>>|<text-at|<scm|E1>|<point|2.13445|0.2>>|<text-at|<scm|y:
        2>|<point|3.03445|-0.399999999999999>>>>|Result of the evaluation of
        <scm|(cdr z)> in terms of E3.>
      </float> shows the result of the evaluation of <scm|(cdr z)> in terms
      of E3.

      <hspace|3ex>With all the value of operand subexpression in
      <scm|(set-car! (cdr z) 17)> obtained. The interpreter still have to get
      the value of the operator subexpression, which is the procedure object
      <scm|set-car!> in E3. So it set up a new environment E6, subordinated
      to E3 in which <scm|m>, the formal parameter of <scm|dispatch>, was
      bound to <scm|'set-car!> and evaluated the body of <scm|dispatch>.
      Hence, this revealed another procedure object <scm|set-x!>. Thus,
      another environment E7 had to be constructed, in which <scm|v>, the
      formal parameter of <scm|set-x!> was bound to the value of
      <scm|new-value>, which is 17. At this point, the interpreter set the
      value of <scm|x> in <scm|E1> to 17. Figure
      <reference|Exercise_3.20-Figure_6><\float|float|tbh>
        <big-figure|<label|Exercise_3.20-Figure_6><with|gr-mode|<tuple|group-edit|move>|gr-frame|<tuple|scale|1cm|<tuple|0.519998gw|288426tmpt>>|gr-geometry|<tuple|geometry|1par|0.6par>|gr-grid|<tuple|empty>|gr-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-edit-grid-aspect|<tuple|<tuple|axes|none>|<tuple|1|none>|<tuple|10|none>>|gr-edit-grid|<tuple|empty>|gr-edit-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-arrow-end|\<gtr\>|gr-auto-crop|true|<graphics||<text-at|<scm|cons,
        car, cdr, set-car!, set-cdr!: ...>|<point|-5.86555|1.96776>>|<with|arrow-end|\<gtr\>|<line|<point|2.13445|0.1>|<point|2.63445|0.1>>>|<text-at|<scm|set-y!:
        ...>|<point|-1.86555|-1.2>>|<with|arrow-end|\<gtr\>|<line|<point|2.83037731250607|-2.829949>|<point|3.33037731250607|-2.829949>>>|<text-at|<scm|dispatch:
        ...>|<point|-1.86555|-1.6>>|<cline|<point|-5.8|-3.0>|<point|-3.4|-3.0>|<point|-3.4|-3.8>|<point|-5.8|-3.8>>|<with|arrow-begin|o|<line|<point|1.8|-0.3>|<point|-1.53732305860564|-0.304755920095251>>>|<cline|<point|-5.96555|3.0>|<point|6.03445|3.0>|<point|6.03445|1.0>|<point|-5.96555|1.0>>|<text-at|<scm|y:
        2>|<point|3.03445|-0.399999999999999>>|<with|arrow-end|\<gtr\>|<line|<point|-7.15299|0.161298>|<point|-6.65299|0.161298>>>|<text-at|<scm|E7>|<point|2.83037731250607|-2.729949>>|<with|arrow-end|\<gtr\>|<line|<point|3.7|-2.6>|<point|3.7|-1.8349>>>|<text-at|<scm|E1>|<point|2.13445|0.2>>|<text-at|<scm|set-x!:>|<point|-1.84547|-0.8>>|<with|arrow-end|\<gtr\>|<line|<point|-6.46555|2.0>|<point|-5.96555|2.0>>>|<with|arrow-end|\<gtr\>|<line|<point|-5.42353|2.73609>|<point|1.8|2.7>|<point|1.8|-1.6>|<point|3.03444569387485|-1.6>>>|<text-at|<scm|E2>|<point|-2.76555|0.2>>|<text-at|<scm|x:>|<point|-1.86555|2.16493489801906e-15>>|<with|arrow-end|\<gtr\>|<line|<point|-0.5|0.3651>|<point|-0.5|1.0>>>|<cline|<point|3.3|-2.6>|<point|4.8|-2.6>|<point|4.8|-3.3>|<point|3.3|-3.3>>|<with|arrow-end|\<gtr\>|<line|<point|-2.76555|0.1>|<point|-2.26555|0.1>>>|<text-at|<scm|E6>|<point|-6.2975|-3.129949>>|<text-at|<scm|E3>|<point|-7.0975|0.270051>>|<cline|<point|-2.26555|0.3651>|<point|1.13445|0.3651>|<point|1.13445|-1.8349>|<point|-2.26555|-1.8349>>|<text-at|call
        to <scm|dispatch> in E1|<point|-6.3|-4.1>>|<with|arrow-end|\<gtr\>|<line|<point|-6.2975|-3.229949>|<point|-5.7975|-3.229949>>>|<cline|<point|-6.5975|0.370051>|<point|-3.6975|0.370051>|<point|-3.6975|-0.629949>|<point|-6.5975|-0.629949>>|<gr-group|<text-at|<scm|z)>|<point|-6.936993|-1.796089>>|<text-at|<scm|((z
        'set-car!)>|<point|-6.936993|-0.996089>>|<text-at|<scm|new-value)>|<point|-6.7|-1.4>>>|<text-at|<scm|m:
        'set-car!>|<point|-5.58297724566742|-3.44318692948803>>|<with|arrow-end|\<gtr\>|<line|<point|-4.0|0.370051>|<point|-4.0|1.0>>>|<text-at|<scm|y:>|<point|-1.86555|-0.399999999999999>>|<with|arrow-begin|o|<line|<point|1.8|0.1>|<point|-1.53732305860564|0.0974136790580761>>>|<text-at|<scm|x:>|<point|-5.86555|2.66776>>|<cline|<point|2.63445|0.3651>|<point|6.03445|0.3651>|<point|6.03445|-1.8349>|<point|2.63445|-1.8349>>|<text-at|<scm|set-y!:
        ...>|<point|3.03445|-1.2>>|<text-at|<scm|v:
        17>|<point|3.6|-3.05859>>|<text-at|<scm|dispatch:
        ...>|<point|3.03445|-1.6>>|<gr-group|<text-at|<scm|env>|<point|-7.06555|2.1>>|<text-at|<scm|global>|<point|-7.06555|2.4>>>|<with|arrow-end|\<gtr\>|<line|<point|4.4|0.3651>|<point|4.4|1.0>>>|<text-at|<scm|set-x!:>|<point|3.05453|-0.8>>|<text-at|<scm|(set!
        x v)>|<point|3.2|-3.7>>|<text-at|<scm|x:
        1>|<point|3.03445|2.16493489801906e-15>>|<text-at|<scm|z:>|<point|-5.88030486836883|1.26905013890726>>|<with|arrow-end|\<gtr\>|<line|<point|-4.4|-3.0>|<point|-4.4|-0.629949>>>|<text-at|<scm|new-value:
        17>|<point|-6.1975|-0.391609>>|<with|arrow-end|o|<line|<point|-5.89653062574415|0.0939575340653532>|<point|-4.0|0.1>|<point|-4.0|-2.2>|<point|1.5|-2.2>|<point|1.5|-0.8>|<point|1.8|-0.8>>>|<with|arrow-end|\<gtr\>|<line|<point|-5.55786148961503|1.38858976055034>|<point|-3.0|1.4>|<point|-3.0|-1.5>|<point|-1.90684945098558|-1.52114036248181>>>|<text-at|<scm|z:>|<point|-6.1975|-0.0299489999999998>>>>|Environments
        generated in the process of evaluating <scm|(set-car! (cdr z) 17)>.>
      </float> shows the environments generated in the process of evaluating
      <scm|(set-car! (cdr z) 17)> in a quite clear way.

      <hspace|3ex>When the evaluation of the expression <scm|(set-car! (cdr
      z) 17)> terminated, environments other than E1 and E2 disappeared,
      together with <scm|x> in E1 been set to 17. Figure
      <reference|Exercise_3.20-Figure_7><\float|float|tbh>
        <big-figure|<label|Exercise_3.20-Figure_7><with|gr-mode|<tuple|group-edit|move>|gr-frame|<tuple|scale|1cm|<tuple|0.519998gw|293868tmpt>>|gr-geometry|<tuple|geometry|1par|0.6par>|gr-grid|<tuple|empty>|gr-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-edit-grid-aspect|<tuple|<tuple|axes|none>|<tuple|1|none>|<tuple|10|none>>|gr-edit-grid|<tuple|empty>|gr-edit-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-arrow-end|\<gtr\>|gr-auto-crop|true|<graphics||<text-at|<scm|dispatch:
        ...>|<point|3.03445|-2.6>>|<text-at|<scm|set-x!:>|<point|3.05453|-1.8>>|<cline|<point|2.63445|-0.6349>|<point|6.03445|-0.6349>|<point|6.03445|-2.8349>|<point|2.63445|-2.8349>>|<with|arrow-end|\<gtr\>|<line|<point|4.4|-0.6349>|<point|4.4|-1.66533453693773e-16>>>|<text-at|<scm|x:
        17>|<point|3.03445|-0.999999999999998>>|<text-at|<scm|y:
        2>|<point|3.03445|-1.4>>|<with|arrow-end|\<gtr\>|<line|<point|2.13445|-0.9>|<point|2.63445|-0.9>>>|<with|arrow-end|\<gtr\>|<line|<point|-5.42353|1.73609>|<point|1.8|1.7>|<point|1.8|-2.6>|<point|3.03444569387485|-2.6>>>|<text-at|<scm|set-y!:
        ...>|<point|-1.86555|-2.2>>|<text-at|<scm|y:>|<point|-1.86555|-1.4>>|<text-at|<scm|dispatch:
        ...>|<point|-1.86555|-2.6>>|<text-at|<scm|x:>|<point|-1.86555|-0.999999999999998>>|<with|arrow-begin|o|<line|<point|1.8|-0.9>|<point|-1.53732305860564|-0.902586320941924>>>|<text-at|<scm|E1>|<point|2.13445|-0.8>>|<text-at|<scm|set-y!:
        ...>|<point|3.03445|-2.2>>|<with|arrow-begin|o|<line|<point|1.8|-1.3>|<point|-1.53732305860564|-1.30475592009525>>>|<text-at|<scm|z:>|<point|-5.88030486836883|0.26905013890726>>|<with|arrow-end|\<gtr\>|<line|<point|-2.76555|-0.9>|<point|-2.26555|-0.9>>>|<text-at|<scm|x:>|<point|-5.86555|1.66776>>|<with|arrow-end|\<gtr\>|<line|<point|-6.46555|1.0>|<point|-5.96555|1.0>>>|<cline|<point|-5.96555|2.0>|<point|6.03445|2.0>|<point|6.03445|-1.66533453693773e-16>|<point|-5.96555|-1.66533453693773e-16>>|<gr-group|<text-at|<scm|env>|<point|-7.06555|1.1>>|<text-at|<scm|global>|<point|-7.06555|1.4>>>|<with|arrow-end|\<gtr\>|<line|<point|-5.55786148961503|0.38858976055034>|<point|-3.0|0.4>|<point|-3.0|-2.5>|<point|-1.90684945098558|-2.52114036248181>>>|<cline|<point|-2.26555|-0.6349>|<point|1.13445|-0.6349>|<point|1.13445|-2.8349>|<point|-2.26555|-2.8349>>|<text-at|<scm|E2>|<point|-2.76555|-0.8>>|<text-at|<scm|cons,
        car, cdr, set-car!, set-cdr!: ...>|<point|-5.86555|0.96776>>|<text-at|<scm|set-x!:>|<point|-1.84547|-1.8>>|<with|arrow-end|\<gtr\>|<line|<point|-0.499999999999999|-0.6349>|<point|-0.499999999999999|-1.66533453693773e-16>>>>>|Environments
        after the evaluation of <scm|(set-car! (cdr z) 17)>.>
      </float> shows the situation after the evaluation of <scm|(set-car!
      (cdr z) 17)>.\ 

      <hspace|3ex>Finally, when trying to evaluate the expression <scm|(car
      x)> in the global environment, the interpreter set up another new
      environment E8 subordinate to the global environment in which <scm|z>,
      the formal parameter of <scm|car> was bound to <scm|x> of the global
      environment. We know that the value of <scm|x> in the global
      environment is the binding of the internal procedure <scm|dispatch> in
      E1. In other word, evaluting <scm|(car z)> associated the formal
      parameter of the procedure object <scm|car> to the internal procedure
      <scm|dispatch> of E1. Hence, this established another new environment
      E9 subordinated to E1 in which <scm|m>, the formal parameter of
      <scm|dispatch> was bound to <scm|'car> and evaluated the body of
      <scm|dispatch>. At this point, it is quite straightforward to obtain
      the value of <scm|(car x)> in E1, which is 17. Figure
      <reference|Exercise_3.20-Figure_8><\float|float|tbh>
        <big-figure|<label|Exercise_3.20-Figure_8><with|gr-mode|<tuple|edit|line>|gr-frame|<tuple|scale|1cm|<tuple|0.519998gw|321078tmpt>>|gr-geometry|<tuple|geometry|1par|0.6par>|gr-grid|<tuple|empty>|gr-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-edit-grid-aspect|<tuple|<tuple|axes|none>|<tuple|1|none>|<tuple|10|none>>|gr-edit-grid|<tuple|empty>|gr-edit-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-arrow-end|\<gtr\>|gr-auto-crop|true|<graphics||<text-at|<scm|dispatch:
        ...>|<point|3.03445|-1.6>>|<text-at|<scm|set-x!:>|<point|3.05453|-0.8>>|<cline|<point|2.63445|0.3651>|<point|6.03445|0.3651>|<point|6.03445|-1.8349>|<point|2.63445|-1.8349>>|<with|arrow-end|\<gtr\>|<line|<point|4.4|0.3651>|<point|4.4|1.0>>>|<text-at|<scm|x:
        17>|<point|3.03445|1.83186799063151e-15>>|<text-at|<scm|y:
        2>|<point|3.03445|-0.4>>|<with|arrow-end|\<gtr\>|<line|<point|2.13445|0.0999999999999998>|<point|2.63445|0.0999999999999998>>>|<text-at|<scm|set-y!:
        ...>|<point|-1.86555|-1.2>>|<text-at|<scm|y:>|<point|-1.86555|-0.4>>|<text-at|<scm|dispatch:
        ...>|<point|-1.86555|-1.6>>|<text-at|<scm|x:>|<point|-1.86555|1.83186799063151e-15>>|<with|arrow-begin|o|<line|<point|1.8|0.0999999999999998>|<point|-1.53732305860564|0.0974136790580758>>>|<text-at|<scm|E1>|<point|2.13445|0.2>>|<text-at|<scm|set-y!:
        ...>|<point|3.03445|-1.2>>|<with|arrow-begin|o|<line|<point|1.8|-0.3>|<point|-1.53732305860564|-0.30475592009525>>>|<text-at|<scm|z:>|<point|-5.88030486836883|1.26905013890726>>|<with|arrow-end|\<gtr\>|<line|<point|-2.76555|0.0999999999999998>|<point|-2.26555|0.0999999999999998>>>|<text-at|<scm|x:>|<point|-5.86555|2.66776>>|<with|arrow-end|\<gtr\>|<line|<point|-6.46555|2.0>|<point|-5.96555|2.0>>>|<cline|<point|-5.96555|3.0>|<point|6.03445|3.0>|<point|6.03445|1.0>|<point|-5.96555|1.0>>|<gr-group|<text-at|<scm|env>|<point|-7.06555|2.1>>|<text-at|<scm|global>|<point|-7.06555|2.4>>>|<with|arrow-end|\<gtr\>|<line|<point|-5.55786148961503|1.38858976055034>|<point|-3.0|1.4>|<point|-3.0|-1.5>|<point|-1.90684945098558|-1.52114036248181>>>|<cline|<point|-2.26555|0.3651>|<point|1.13445|0.3651>|<point|1.13445|-1.8349>|<point|-2.26555|-1.8349>>|<text-at|<scm|E2>|<point|-2.76555|0.2>>|<text-at|<scm|cons,
        car, cdr, set-car!, set-cdr!: ...>|<point|-5.86555|1.96776>>|<text-at|<scm|set-x!:>|<point|-1.84547|-0.8>>|<with|arrow-end|\<gtr\>|<line|<point|-0.499999999999999|0.3651>|<point|-0.499999999999999|1.0>>>|<cline|<point|-5.2|-1.66533453693773e-16>|<point|-4.0|-1.66533453693773e-16>|<point|-4.0|-0.8>|<point|-5.2|-0.8>>|<text-at|<scm|z:>|<point|-5.0|-0.5>>|<with|arrow-end|\<gtr\>|<line|<point|-5.74663|-0.19274>|<point|-5.24663|-0.19274>>>|<text-at|<scm|E8>|<point|-5.8311|-0.1>>|<text-at|<scm|(z
        'car)>|<point|-5.3|-1.2>>|<with|arrow-end|\<gtr\>|<line|<point|-4.6|0>|<point|-4.6|1.0>>>|<with|arrow-end|\<gtr\>|<line|<point|2.94293|-2.97973>|<point|3.44293|-2.97973>>>|<text-at|<scm|E9>|<point|2.94293|-2.87973>>|<gr-group|<cline|<point|3.5|-2.8>|<point|5.4|-2.8>|<point|5.4|-3.6>|<point|3.5|-3.6>>|<text-at|<scm|m:
        'car>|<point|3.8221821669533|-3.2624619658685>>>|<with|arrow-end|o|<line|<point|-4.6688550072761|-0.404848524937161>|<point|-3.5|-0.4>|<point|-3.5|-2.5>|<point|1.5|-2.5>|<point|1.5|-0.7>|<point|1.8|-0.7>>>|<text-at|call
        to <scm|dispatch>|<point|3.3|-4.0>>|<with|arrow-end|\<gtr\>|<line|<point|4.49638|-2.81787>|<point|4.5|-1.8349>>>|<with|arrow-end|\<gtr\>|<line|<point|-5.53669466860696|2.79140759359704>|<point|1.8|2.8>|<point|1.8|-1.6>|<point|3.03444569387485|-1.6>>>>>|Environment
        structure in evaluating <scm|(car x)>.>
      </float> shows the environment structure in evaluating <scm|(car x)>.
    </answer>
  </render-exercise>
</body>

<\initial>
  <\collection>
    <associate|font-base-size|11>
  </collection>
</initial>

<\references>
  <\collection>
    <associate|Exercise_3.20-Figure_1|<tuple|1|1>>
    <associate|Exercise_3.20-Figure_2|<tuple|2|2>>
    <associate|Exercise_3.20-Figure_3|<tuple|3|3>>
    <associate|Exercise_3.20-Figure_4|<tuple|4|3>>
    <associate|Exercise_3.20-Figure_5|<tuple|5|4>>
    <associate|Exercise_3.20-Figure_6|<tuple|6|4>>
    <associate|Exercise_3.20-Figure_7|<tuple|7|?>>
    <associate|Exercise_3.20-Figure_8|<tuple|8|?>>
    <associate|auto-1|<tuple|1|1>>
    <associate|auto-2|<tuple|2|2>>
    <associate|auto-3|<tuple|3|3>>
    <associate|auto-4|<tuple|4|3>>
    <associate|auto-5|<tuple|5|4>>
    <associate|auto-6|<tuple|6|4>>
    <associate|auto-7|<tuple|7|5>>
    <associate|auto-8|<tuple|8|?>>
    <associate|footnote-|<tuple|?|?>>
    <associate|footnote-*|<tuple|?|1>>
    <associate|footnote-*Creative Commons \ 2013, Lawrence X. Amlord
    (\<#989C\>\<#4E16\>\<#654F\>, aka \<#989C\> \<#5E8F\>)|<tuple|?|?>>
    <associate|footnote-*Creative Commons \ 2013, Lawrence X. Amlord
    (\<#989C\>\<#4E16\>\<#654F\>, aka \<#989C\> \<#5E8F\>).|<tuple|?|?>>
  </collection>
</references>

<\auxiliary>
  <\collection>
    <\associate|figure>
      <tuple|normal|Environment structure produced by evaluting
      <with|mode|<quote|prog>|prog-language|<quote|scheme>|(define (cons x y)
      ...)> etc. in the global environment.|<pageref|auto-1>>

      <tuple|normal|Environments created in evaluating
      <with|mode|<quote|prog>|prog-language|<quote|scheme>|(define x (cons 1
      2))>|<pageref|auto-2>>

      <tuple|normal|Environments established during the evaluation of
      <with|mode|<quote|prog>|prog-language|<quote|scheme>|(define z (cons x
      x))>|<pageref|auto-3>>

      <tuple|normal|Environments in the evaluation of
      <with|mode|<quote|prog>|prog-language|<quote|scheme>|(cdr z)> in terms
      of E3.|<pageref|auto-4>>

      <tuple|normal|Result of the evaluation of
      <with|mode|<quote|prog>|prog-language|<quote|scheme>|(cdr z)> in terms
      of E3.|<pageref|auto-5>>

      <tuple|normal|Environments generated in the process of evaluating
      <with|mode|<quote|prog>|prog-language|<quote|scheme>|(set-car! (cdr z)
      17)>.|<pageref|auto-6>>

      <tuple|normal|Environments after the evaluation of
      <with|mode|<quote|prog>|prog-language|<quote|scheme>|(set-car! (cdr z)
      17)>.|<pageref|auto-7>>

      <tuple|normal||<pageref|auto-8>>
    </associate>
  </collection>
</auxiliary>