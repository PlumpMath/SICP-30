<TeXmacs|1.0.7.19>

<style|generic>

<\body>
  <\render-exercise|Exercise 3.23>
    <render-footnote|*|Creative Commons <image|<tuple|<#89504E470D0A1A0A0000000D49484452000000580000001F080600000063C80AE0000000097048597300000B1300000B1301009A9C1800000A4F6943435050686F746F73686F70204943432070726F66696C65000078DA9D53675453E9163DF7DEF4424B8880944B6F5215082052428B801491262A2109104A8821A1D91551C1114545041BC8A088038E8E808C15512C0C8A0AD807E421A28E83A3888ACAFBE17BA36BD6BCF7E6CDFEB5D73EE7ACF39DB3CF07C0080C9648335135800CA9421E11E083C7C4C6E1E42E40810A2470001008B3642173FD230100F87E3C3C2B22C007BE000178D30B0800C04D9BC0301C87FF0FEA42995C01808401C07491384B08801400407A8E42A600404601809D98265300A0040060CB6362E300502D0060277FE6D300809DF8997B01005B94211501A09100201365884400683B00ACCF568A450058300014664BC43900D82D00304957664800B0B700C0CE100BB200080C00305188852900047B0060C8232378008499001446F2573CF12BAE10E72A00007899B23CB9243945815B082D710757572E1E28CE49172B14366102619A402EC27999193281340FE0F3CC0000A0911511E083F3FD78CE0EAECECE368EB60E5F2DEABF06FF226262E3FEE5CFAB70400000E1747ED1FE2C2FB31A803B06806DFEA225EE04685E0BA075F78B66B20F40B500A0E9DA57F370F87E3C3C45A190B9D9D9E5E4E4D84AC4425B61CA577DFE67C25FC057FD6CF97E3CFCF7F5E0BEE22481325D814704F8E0C2CCF44CA51CCF92098462DCE68F47FCB70BFFFC1DD322C44962B9582A14E35112718E449A8CF332A52289429229C525D2FF64E2DF2CFB033EDF3500B06A3E017B912DA85D6303F64B27105874C0E2F70000F2BB6FC1D4280803806883E1CF77FFEF3FFD47A02500806649927100005E44242E54CAB33FC708000044A0812AB0411BF4C1182CC0061CC105DCC10BFC6036844224C4C24210420A64801C726029AC82422886CDB01D2A602FD4401D34C051688693700E2EC255B80E3D700FFA61089EC128BC81090441C808136121DA8801628A58238E08179985F821C14804128B2420C9881451224B91354831528A542055481DF23D720239875C46BA913BC8003282FC86BC47319481B2513DD40CB543B9A8371A8446A20BD06474319A8F16A09BD072B41A3D8C36A1E7D0AB680FDA8F3E43C730C0E8180733C46C302EC6C342B1382C099363CBB122AC0CABC61AB056AC03BB89F563CFB17704128145C0093604774220611E4148584C584ED848A8201C243411DA093709038451C2272293A84BB426BA11F9C4186232318758482C23D6128F132F107B8843C437241289433227B9900249B1A454D212D246D26E5223E92CA99B34481A2393C9DA646BB20739942C202BC885E49DE4C3E433E41BE421F25B0A9D624071A4F853E22852CA6A4A19E510E534E5066598324155A39A52DDA8A15411358F5A42ADA1B652AF5187A81334759A39CD8316494BA5ADA295D31A681768F769AFE874BA11DD951E4E97D057D2CBE947E897E803F4770C0D861583C7886728199B18071867197718AF984CA619D38B19C754303731EB98E7990F996F55582AB62A7C1591CA0A954A9526951B2A2F54A9AAA6AADEAA0B55F355CB548FA95E537DAE46553353E3A909D496AB55AA9D50EB531B5367A93BA887AA67A86F543FA47E59FD890659C34CC34F43A451A0B15FE3BCC6200B6319B3782C216B0DAB86758135C426B1CDD97C762ABB98FD1DBB8B3DAAA9A13943334A3357B352F394663F07E39871F89C744E09E728A797F37E8ADE14EF29E2291BA6344CB931655C6BAA96979658AB48AB51AB47EBBD36AEEDA79DA6BD45BB59FB810E41C74A275C2747678FCE059DE753D953DDA70AA7164D3D3AF5AE2EAA6BA51BA1BB4477BF6EA7EE989EBE5E809E4C6FA7DE79BDE7FA1C7D2FFD54FD6DFAA7F5470C5806B30C2406DB0CCE183CC535716F3C1D2FC7DBF151435DC34043A561956197E18491B9D13CA3D5468D460F8C69C65CE324E36DC66DC6A326062621264B4DEA4DEE9A524DB9A629A63B4C3B4CC7CDCCCDA2CDD699359B3D31D732E79BE79BD79BDFB7605A785A2CB6A8B6B86549B2E45AA659EEB6BC6E855A3959A558555A5DB346AD9DAD25D6BBADBBA711A7B94E934EAB9ED667C3B0F1B6C9B6A9B719B0E5D806DBAEB66DB67D6167621767B7C5AEC3EE93BD937DBA7D8DFD3D070D87D90EAB1D5A1D7E73B472143A563ADE9ACE9CEE3F7DC5F496E92F6758CF10CFD833E3B613CB29C4699D539BD347671767B97383F3888B894B82CB2E973E2E9B1BC6DDC8BDE44A74F5715DE17AD2F59D9BB39BC2EDA8DBAFEE36EE69EE87DC9FCC349F299E593373D0C3C843E051E5D13F0B9F95306BDFAC7E4F434F8167B5E7232F632F9157ADD7B0B7A577AAF761EF173EF63E729FE33EE33C37DE32DE595FCC37C0B7C8B7CB4FC36F9E5F85DF437F23FF64FF7AFFD100A78025016703898141815B02FBF87A7C21BF8E3F3ADB65F6B2D9ED418CA0B94115418F82AD82E5C1AD2168C8EC90AD21F7E798CE91CE690E85507EE8D6D00761E6618BC37E0C2785878557863F8E7088581AD131973577D1DC4373DF44FA449644DE9B67314F39AF2D4A352A3EAA2E6A3CDA37BA34BA3FC62E6659CCD5589D58496C4B1C392E2AAE366E6CBEDFFCEDF387E29DE20BE37B17982FC85D7079A1CEC2F485A716A92E122C3A96404C884E3894F041102AA8168C25F21377258E0A79C21DC267222FD136D188D8435C2A1E4EF2482A4D7A92EC91BC357924C533A52CE5B98427A990BC4C0D4CDD9B3A9E169A76206D323D3ABD31839291907142AA214D93B667EA67E66676CBAC6585B2FEC56E8BB72F1E9507C96BB390AC05592D0AB642A6E8545A28D72A07B267655766BFCD89CA3996AB9E2BCDEDCCB3CADB90379CEF9FFFED12C212E192B6A5864B572D1D58E6BDAC6A39B23C7179DB0AE315052B865606AC3CB88AB62A6DD54FABED5797AE7EBD267A4D6B815EC1CA82C1B5016BEB0B550AE5857DEBDCD7ED5D4F582F59DFB561FA869D1B3E15898AAE14DB1797157FD828DC78E51B876FCABF99DC94B4A9ABC4B964CF66D266E9E6DE2D9E5B0E96AA97E6970E6E0DD9DAB40DDF56B4EDF5F645DB2F97CD28DBBB83B643B9A3BF3CB8BC65A7C9CECD3B3F54A454F454FA5436EED2DDB561D7F86ED1EE1B7BBCF634ECD5DB5BBCF7FD3EC9BEDB5501554DD566D565FB49FBB3F73FAE89AAE9F896FB6D5DAD4E6D71EDC703D203FD07230EB6D7B9D4D51DD23D54528FD62BEB470EC71FBEFE9DEF772D0D360D558D9CC6E223704479E4E9F709DFF71E0D3ADA768C7BACE107D31F761D671D2F6A429AF29A469B539AFB5B625BBA4FCC3ED1D6EADE7AFC47DB1F0F9C343C59794AF354C969DAE982D39367F2CF8C9D959D7D7E2EF9DC60DBA2B67BE763CEDF6A0F6FEFBA1074E1D245FF8BE73BBC3BCE5CF2B874F2B2DBE51357B8579AAF3A5F6DEA74EA3CFE93D34FC7BB9CBB9AAEB95C6BB9EE7ABDB57B66F7E91B9E37CEDDF4BD79F116FFD6D59E393DDDBDF37A6FF7C5F7F5DF16DD7E7227FDCECBBBD97727EEADBC4FBC5FF440ED41D943DD87D53F5BFEDCD8EFDC7F6AC077A0F3D1DC47F7068583CFFE91F58F0F43058F998FCB860D86EB9E383E3939E23F72FDE9FCA743CF64CF269E17FEA2FECBAE17162F7EF8D5EBD7CED198D1A197F29793BF6D7CA5FDEAC0EB19AFDBC6C2C61EBEC97833315EF456FBEDC177DC771DEFA3DF0F4FE47C207F28FF68F9B1F553D0A7FB93199393FF040398F3FC63332DDB0000000467414D410000B18E7CFB5193000000206348524D00007A25000080830000F9FF000080E9000075300000EA6000003A980000176F925FC54600000A6F4944415478DAEC5A6D6C53D7197EEEB58946273CFFDB2607618436C591561C0AB474B4B1D7AD534BD35C2F295FA1C3665ADB9575494A08DBC897814063421DF7539BD6C46B57B55AA9305F6B173A7C43D0E2C4496C468BF363958D92A8549BE6E0A0A9C41FEF7E5CDF13DFC44E1C68D58EF6958EEFF13DE73CF7DCE7BCE73DEF79CFE58848C371DC557C259FBA1011C701200038DD7D0A3CCF83E779A8542AF0BC0A2A9E07AF4A5F791E1CC783E738701C07709C8C020281528414A5904A4929994C4AD75412C9640AA9549295A528C5EA1391DC1996BF15E491F28D00000E00C9E4AA542A29F1AAE9BC4A2595F1AA34C91C388ECFE4374D4E9AD894446632994E99F9A492E4542AC588CD24FA5622590D4049AE4A0DB5E22AA593C74FC1EBF56260600093B14905D012CD12AC5DBB16E61F9851F6F04348A654E0F9843420491E1CB8F458664C9F14493301E939C449E40EFB03F0BCED41281452D437180C102A04AC5A5392D7CB7D51703800F4D7B3EF42AD563352D56AB594546AF488E7E078C681F1F1F1BC3AA4D3E950FF9B7A9496DE8B44328964328144229D9209241249A6E1999AFCD1F84778BEE3058C8446000026930946A31100100C06218A2200A0C850849DD53BF1AD6F7F33EBF3AF7CF4315E74BDF885C079A47CA344F07B3D67A056A9A789552FC222B51ACD8D2DF01CF3B0065AAD16822040AFD7A3B4B41400D0D3D3834824028FC7838989095657B008A8ABDF85C5B72D462291403C91402211472291509A0C4AE16AF42A7EF9C45388C5621004014EA7137ABD5ED1D9482482DADA5A783C1E68341AB43A5A67BDD4B5D83554EFACF9C2E0C87698CEF69EA5DEBE73D4E7EFA3C1A09F2EBC1F24C122507AF29256ABA59696168A46A334977475759156AB65ED8A0C4574BEAF97068383E41BECA3DEBE73E4ED3D4B67C46E7AF76FEFD0E9EE5374E29DE3643018080059AD56059E8C33F31932F65BC7FFAC484586A2AC382EA793B66EDA7C5338A3A3A3E4EBEB235F5F1F8D8E8EE6850380780050A56DB05AA5825AA5D45CA3D188402080E6E66668B5DA39CD83D56A45381C66536924348276C711852DE799472279237E9F1FA150088220A07EF7EE794D90D56A85200818098D60D81F50D8CA91D008569594E0EEBBD6B1FBCF7574E0198703274F9FC69EBADD181B1BCB0B27B33F7F7AF55598D6DF83AACD5B50B5790B4CEBEFC199EEEE397114EB4DAFAF977C833E1ABE3044AEE75D4C738C46E3BC5A9B4DA2D128198D4686E37AC145C3FF18A6FE211F9DF7F592F7BCA4C5EFBCF71732144BDA1B0E87F3C60F87C304800C0603D3167916147DE7BBB462999E4ABFBF9E9EF8F96304805A5A5AE8D0C14304808EBEF5565E38727F7C7D7D12DE9DEBE867DB6D54BFAB8E562CD3D38A657A72399D3971B268B0A4C58E671CCCDE767575CDABB5D944ABD5C2EBF5B2B68E438EB42F9DD6602EED53F33C42974230994CB36C9CCD66635A6EB3D914657ABD1E269349B1B28742124E5959191ED9B81163636338D3DD8D15CBF4F8EFE4356C7B741B2E7DF0012A2A2BF3C2D1EBF588C56208052E0200CA859FE00FEE4EB4B51FC6DEA6460080BBB32B278E2CBCECA6F1BCE48AC9DE424D4D0D9BEA37225AAD164EA71300303E3E8E93274EB10D8B4432C7DCB46CCF71BBDD59F3B2646B63341AE138D28E438E36BCFEE61BA8A8ACC4879723701C69C7D2A54BE1EEEC42E8D2A5BC7064697D5652B8DFFFF11576EF47F7DF0F0088C562F8F8CA959C388C60599BBC5E2F23A7BABA9A55124511168B0566B31966B31976BB3D6759474787C25ECA5AEC3DEBCDD05E0E1C3F4DF0672177DE7517DADA0F63747414F5BBEA50F2BDDBF1F6D1A3287B7003AA366F6136742ED1683470B95CB84DB3042FBFFC72D63A9F7C727D4E0C69A3C171E0390E030303928B25088C18511461369B158D445184288AA8AEAE86C562995576E1C205747575312CB7DB8D81810169079826562297637E65B6C54CD65CABD53AAB3C5B9B99F762B118CE7477A3ADFD30AC976C287B700300A0DFE743BFCF87C2C242708BD473E22C52AB515F5787DB162F66F7FA7D3E965FA65F96B33F191A2CBDB0BC435BB97225AB505B5BCBEC4C381C86D7EB855EAFC7F6EDDB99261B8D4684C3611C3B764CE1230360F9C9D8A4F41C701957A0B8B818A228221289283A260FD0CCBCEC838AA20883C1A0D859CDC4F9C5638FA375DF7EACBA7D25AA366FC1879723A8A8AC445BFB61546DDB9617CED8D8185A9A9AB175D366B4EEDB8FD67DFBD1D4D00000D8BD674FCEFE28080607C574CDB427F2C858AD5666CCC3E130AC562B2B93371F8220B0B2CC85846D1B39F633ED8C6FAA540C643E22D7152A84E98D4D3A9F89D3D67E18B61D3B70E5DFFFC23FC361B89C4EEC6D6A44456525EC07F6A364CDEA79716C3B76C0B6638734D09D9DE8EAECC4F54FAE6343D943D852B535677F1426E2F39475EBD7C1506C80C7E381CD669BA5ADD9C8F5783C28321429E200ABD694A0C850A4C0292C2CC4DEA6467C6DF1620C0F0DE15735353784B3B7A9113F7EE0015CBE2C69757171310CC5C573E22835989451AC4C7B226BB3DBEDC6C4C40482C120962F5F0EBBDDCECAE46D726659E6749E8E8FB21F45271A5B1AA1D168E076BB61B158589BCC285B241281C56241474707341A0D7656EF9CF5327B7E5B9F1567D7EE3ABCFEE61B3785B37ACD6A545456A2A2B21286E2E2BC7058B0C73F3C80828202ACBFFB1E4CC62661B55A9926793C9E590B996C32CACBCB7396C9ED6B6B6BD1D1D181259A2538FFF75E4C4D4D612A3E8578228E783C210583920944FF338183F683CC97341A8D301A8DD06AB51045910DFA7C419A6BB16B683BE860419ACF1387057BFA87FA515050007B931D9E631E68B55A44A3518567E072B95830C76432A1B9B9990D80CBE5627533CB0060F9F2E5884422B8EF87F7E188B31DD7A7A6109F41B01C374E2553F0F7FB71ECE8AD11AE6404FB06FBB0685101CE9F3B8FEAA724FFD7E974A226C366DD88B8DD6EB60B3B70F0001EDCF000A6E253988AC79188C7114FCC20384B00FEFF3DE0CE0360473A267329743A1D00C06EB7CF729D16221313136C75D5E974E9407CFA142395422A6D8B297DE474AB0A0F00294A219994CED1F6B7EE6304592C16458C7721E49ACD66D6B6FED7F5E9007B729AE48C2323B6C8D2AD7564C4167700D4D0DC40FEE1010A5E0CD0A33F7D5411510B04020B8A746546D2048B40C18B01F20F0FD0BED67DECFE97284DFFA979BA9A06037E0ADE40C03D1A8D524B4B8B22E0BE66ED1ABAF07E9006837E6A686EF832924BDC4CA7B4B1B901E516016AB51A471C47F0DAABAFDDF091917D7F0B128904FAFB07F0E4E34FE6F31D41C6AE8F63F732779933FFE7C2C9D5467E46BE81A65C7D5A10C6CCD4D8DC2069F2C50075BA5F219D4E97F788E9743A723DEFA2E0C5000D06FDF4D2EF5ECABBEDCC63A299F9CC7BF3E1CCD73E1FAC6C75168A314B8365A979BA1A55DBAAD8518FE8EDC189E327E63CB67F5878182653293BD03C7EFC040ED80F2CE44B9859DAB210CD9D5937D775815FE764D5DE5CFDCCBA93CB55B8EA8E12343637A170A92EE3342233DC0885DF2A7F78323E368667DB9D38D7736EC12F7333A6613E933017FE42072D5F8C390996E5DED27BB1A16C03EE587D07BEA1D1A43F9D9A36304484ABB11886068770FAE4E90513FB5969F0CDDAE0F9D6844F8DE0AFE426361A44F4F5AF68F88C361844DCFF06006DC21432895ADA920000000049454E44AE426082>|png>|1.20cm|0.42cm||>
    2013, Lawrence X. Amlord (<with|font|heiti|\<#989C\>\<#4E16\>\<#654F\>>,
    aka <with|font|heiti|\<#989C\> \<#5E8F\>>).>

    A <with|font-shape|italic|deque> (``double-ended queue'') is a sequence
    in which items can be inserted and deleted at either the front or the
    rear. Operations on deques are the constructor <scm|make-deque>, the
    predicate <scm|empty-deque?>, selectors <scm|front-deque> and
    <scm|rear-deque>, and mutators <scm|front-insert-deque!>,
    <scm|rear-insert-deque!>, <scm|front-delete-deque!>, and
    <scm|rear-delete-deque!>. Show how to represent deques using pairs, and
    give implementations of the operations.<\footnote>
      Be careful not to make the interpreter try to print a structure that
      contains cycles. (See exercise 3.13.)
    </footnote> All operations should be accomplished in <math|\<Theta\>
    <around*|(|1|)>> steps.

    <\answer>
      \;

      Figure <reference|Exercise_3.23-Figure_1><\float|float|tbh>
        <big-figure|<label|Exercise_3.23-Figure_1><with|gr-mode|<tuple|group-edit|group-ungroup>|gr-frame|<tuple|scale|1cm|<tuple|0.5gw|0.5gh>>|gr-geometry|<tuple|geometry|1par|0.6par>|gr-grid|<tuple|empty>|gr-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-edit-grid-aspect|<tuple|<tuple|axes|none>|<tuple|1|none>|<tuple|10|none>>|gr-edit-grid|<tuple|empty>|gr-edit-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-auto-crop|true|<graphics||<gr-group|<text-at|Operation|<point|-4.2|1.130481>>|<text-at|<scm|(rear-delete-deque!
        dq)>|<point|-4.2|-1.869519>>|<text-at|<scm|(rear-insert-deque! dq
        'd)>|<point|-4.2|-2.369519>>|<text-at|<scm|(front-delete-deque!
        dq)>|<point|-4.2|-0.869519>>|<text-at|<scm|(rear-insert-deque! dq
        'c)>|<point|-4.2|-1.369519>>|<text-at|<scm|(front-insert-deque! dq
        'a)>|<point|-4.2|-0.369519>>|<text-at|<scm|(rear-insert-deque! dq
        'b)>|<point|-4.2|0.130481>>|<text-at|<scm|(define dq
        (make-deque))>|<point|-4.2|0.630481>>|<text-at|<scm|b>|<point|1.8|-1.869519>>|<text-at|<scm|b>|<point|1.8|-0.869519>>|<text-at|<scm|b
        d>|<point|1.8|-2.369519>>|<text-at|<scm|b
        c>|<point|1.8|-1.369519>>|<text-at|<scm|b>|<point|1.8|0.130481>>|<text-at|<scm|a
        b>|<point|1.8|-0.369519>>|<text-at|Resulting
        Queue|<point|1.8|1.130481>>>>><anim-constant||0>|Double-ended queue
        operations.>
      </float> shows an initially empty double-ended queue in which the item
      <scm|b> is inserted at the rear of the queue. Then <scm|a> is inserted
      at the front, but sooner it is also removed at the front. <scm|C> is
      inserted and removed at the rear, and <scm|d> is inserted at the rear.

      <hspace|3ex>In terms of data abstraction, we can regard a double-ended
      queue as defined by the following set of operations:

      <\with|par-line-sep|0.025fns>
        <\with|par-par-sep|0.1111fn>
          <math|\<bullet\>> a constructor:

          <scm|(make-deque)>

          returns an empty double-ended queue (a queue containing no
          items).<vspace|0.5fn>

          <math|\<bullet\>> three selectors:

          <scm|(empty-deque? \<less\><with|prog-font-shape|italic|deque>\<gtr\>)>

          test if the doubled-ended queue is empty.<vspace|0.5fn>

          <scm|(front-deque \<less\><with|prog-font-shape|italic|deque>\<gtr\>)>

          returns the object at the front of the double-ended queue,
          signaling an error if the queue is empty; it does not modified the
          queue.<vspace|0.5fn>

          <scm|(rear-deque \<less\><with|prog-font-shape|italic|deque>\<gtr\>)>

          returns the object at the rear of the double-ended queue, signaling
          an error if the queue is empty; it does not modified the queue
          either.<vspace|0.5fn>

          <math|\<bullet\>> four mutators:

          <scm|(front-insert-deque! \<less\><with|prog-font-shape|italic|deque>\<gtr\>
          \<less\><with|prog-font-shape|italic|item>\<gtr\>)>

          inserts the item at the front of the double-ended queue and returns
          the modified queue as its value.<vspace|0.5fn>

          <scm|(rear-insert-deque! \<less\><with|prog-font-shape|italic|deque>\<gtr\>
          \<less\><with|prog-font-shape|italic|item>\<gtr\>)>

          inserts the item at the rear of the double-ended queue and returns
          the modified queue as its value.<vspace|0.5fn>

          <scm|(front-delete-deque! \<less\><with|prog-font-shape|italic|deque>\<gtr\>)>

          removes the item at the front of the double-ended queue and returns
          the modified queue as its value, signaling an error if the queue is
          empty before the deletion.<vspace|0.5fn>

          <scm|(rear-delete-deque! \<less\><with|prog-font-shape|italic|deque>\<gtr\>)>

          removes the item at the rear of the double-ended queue and returns
          the modified queue as its value, signaling an error if the queue is
          empty before the deletion.
        </with>
      </with>
    </answer>

    <hspace|3ex>A double-ended queue is represented, much similar to the
    single-ended queue, as a pair of pointers, <scm|front-ptr> and
    <scm|rear-ptr>, which indicate, respectively, the first and last pairs in
    an ordinary list. Figure <reference|Exercise_3.23-Figure_2><\float|float|tbh>
      <big-figure|<label|Exercise_3.23-Figure_2><with|gr-mode|<tuple|group-edit|group-ungroup>|gr-frame|<tuple|scale|1cm|<tuple|0.5gw|0.5gh>>|gr-geometry|<tuple|geometry|1par|0.6par>|gr-grid|<tuple|empty>|gr-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-edit-grid-aspect|<tuple|<tuple|axes|none>|<tuple|1|none>|<tuple|10|none>>|gr-edit-grid|<tuple|empty>|gr-edit-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-auto-crop|true|<graphics||<gr-group|<with|magnify|0.590117724122821|<cline|<point|-2.89505886206141|-1.40494113793859>|<point|-2.30494113793859|-1.40494113793859>|<point|-2.30494113793859|-1.99505886206141>|<point|-2.89505886206141|-1.99505886206141>>>|<text-at|<scm|a>|<point|-2.73766372668342|-1.78462677476562>>|<with|arrow-end|\<gtr\>|<line|<point|-2.59196|-0.6>|<point|-2.6|-1.4>>>|<with|magnify|0.583914669242297|<cline|<point|-2.8839146692423|-0.30804266537885>|<point|-1.7160853307577|-0.30804266537885>|<point|-1.7160853307577|-0.89195733462115>|<point|-2.8839146692423|-0.89195733462115>>>|<with|magnify|0.583914669242297|<point|-2.59195733462115|-0.6>>|<with|magnify|0.583914669242297|<line|<point|-2.3|-0.30804266537885>|<point|-2.3|-0.89195733462115>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.59196|1.1>|<point|-2.6|-0.30804266537885>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.00804|-0.6>|<point|-0.583914669242302|-0.6>>>|<with|magnify|0.583914669242297|<point|-2.00804266537885|-0.6>>|<text-at|<scm|dq>|<point|-4.18565165398442|1.0>>|<with|arrow-end|\<gtr\>|<line|<point|-3.7|1.1>|<point|-2.8839146692423|1.1>>>|<with|magnify|0.583914669242297|<cline|<point|-2.8839146692423|1.39195733462115>|<point|-1.7160853307577|1.39195733462115>|<point|-1.7160853307577|0.80804266537885>|<point|-2.8839146692423|0.80804266537885>>>|<with|magnify|0.583914669242297|<line|<point|-2.3|1.39195733462115>|<point|-2.3|0.80804266537885>>>|<with|magnify|0.583914669242297|<point|-2.59195733462115|1.1>>|<with|magnify|0.590117724122821|<cline|<point|-0.595058862061412|-1.40494113793859>|<point|-0.00494113793859315|-1.40494113793859>|<point|-0.00494113793859315|-1.99505886206141>|<point|-0.595058862061412|-1.99505886206141>>>|<with|magnify|0.583914669242297|<cline|<point|-0.583914669242302|-0.30804266537885>|<point|0.583914669242299|-0.30804266537885>|<point|0.583914669242299|-0.89195733462115>|<point|-0.583914669242302|-0.89195733462115>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.00804|1.1>|<point|1.8|1.1>|<point|1.8|-0.30804266537885>>>|<with|magnify|0.583914669242297|<point|-2.00804266537885|1.1>>|<text-at|<scm|b>|<point|-0.437663726683422|-1.78462677476562>>|<with|arrow-end|\<gtr\>|<line|<point|-0.291960000000002|-0.6>|<point|-0.300000000000002|-1.4>>>|<text-at|<scm|front-ptr>|<point|-2.4|0.2>>|<with|magnify|0.583914669242297|<point|-0.291957334621152|-0.6>>|<with|magnify|0.583914669242297|<line|<point|-3.24740234702858e-15|-0.30804266537885>|<point|-3.24740234702858e-15|-0.89195733462115>>>|<with|magnify|0.583914669242297|<point|0.291957334621149|-0.6>>|<with|arrow-end|\<gtr\>|<line|<point|0.291959999999999|-0.6>|<point|1.2|-0.6>>>|<with|magnify|0.590117724122821|<cline|<point|1.20494113793859|-1.40494113793859>|<point|1.79505886206141|-1.40494113793859>|<point|1.79505886206141|-1.99505886206141>|<point|1.20494113793859|-1.99505886206141>>>|<with|magnify|0.583914669242297|<cline|<point|1.2160853307577|-0.30804266537885>|<point|2.3839146692423|-0.30804266537885>|<point|2.3839146692423|-0.89195733462115>|<point|1.2160853307577|-0.89195733462115>>>|<text-at|<scm|c>|<point|1.36233627331658|-1.78462677476562>>|<with|arrow-end|\<gtr\>|<line|<point|1.50804|-0.6>|<point|1.5|-1.4>>>|<with|magnify|0.583914669242297|<point|1.50804266537885|-0.6>>|<line|<point|1.8|-0.891957>|<point|2.4|-0.3>>|<with|magnify|0.583914669242297|<line|<point|1.8|-0.30804266537885>|<point|1.8|-0.89195733462115>>>|<text-at|<scm|rear-ptr>|<point|2.0|0.2>>>>>|Implementation
      of a double-ended queue as a list with front and rear pointers.>
    </float> illustrates this representation, which is almost the same as
    figure 3.19.

    <hspace|3ex>The procedures to select and to modify the front and rear
    pointers of a double-ended queue is the same as those of a single-ended
    queue:

    <\scm>
      (define (front-ptr deque) (car deque))

      (define (rear-ptr deque) (cdr deque))

      (define (set-front-ptr! deque item) (set-car! deque item))

      (define (set-rear-ptr! deque item) (set-cdr! deque item))
    </scm>

    <hspace|3ex>Now we can implement the actual queue operations. We will
    consider a double-ended queue to be empty if its front pointer is the
    empty list:

    <\scm-code>
      (define (empty-deque? deque) (null? (front-ptr deque)))
    </scm-code>

    The <scm|make-deque> constructor returns, as an initially empty
    double-ended queue, a pair of empty list:

    <\scm-code>
      (define (make-deque) (cons '() '()))
    </scm-code>

    To select the item at the front of the double-ended queue, we return the
    <scm|car> of the pair indicated by the front pointers respectively:

    <\scm-code>
      (define (front-deque deque)

      \ \ (if (empty-deque? deque)

      \ \ \ \ \ \ (error "FRONT-DEQUE called with an empty double-ended
      queue" deque)

      \ \ \ \ \ \ (car (front-ptr deque))))
    </scm-code>

    <hspace|3ex>Selecting the item located at the rear of the doubled-ended
    queue is almost identical to that of the front:

    <\scm-code>
      (define (rear-deque deque)

      \ \ (if (empty-deque? deque)

      \ \ \ \ \ \ (error "REAR-DEQUE called with an empty double-ended queue"
      deque)

      \ \ \ \ \ \ (car (rear-ptr deque))))
    </scm-code>

    <hspace|3ex>To insert an item at the front of a double-ended queue, we
    follow the method whose result is indicated in figure
    <reference|Exercise_3.23-Figure_3><\float|float|tbh>
      <big-figure|<label|Exercise_3.23-Figure_3><with|gr-mode|<tuple|group-edit|move>|gr-frame|<tuple|scale|1cm|<tuple|0.5gw|0.5gh>>|gr-geometry|<tuple|geometry|1par|0.6par>|gr-grid|<tuple|empty>|gr-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-edit-grid-aspect|<tuple|<tuple|axes|none>|<tuple|1|none>|<tuple|10|none>>|gr-edit-grid|<tuple|empty>|gr-edit-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-auto-crop|true|<graphics||<gr-group|<with|magnify|0.590117724122821|<cline|<point|-3.99505886206141|-1.00494113793859>|<point|-3.40494113793859|-1.00494113793859>|<point|-3.40494113793859|-1.59505886206141>|<point|-3.99505886206141|-1.59505886206141>>>|<text-at|<scm|z>|<point|-3.83766372668342|-1.38462677476562>>|<with|arrow-end|\<gtr\>|<line|<point|-3.69196|-0.2>|<point|-3.7|-1.0>>>|<with|magnify|0.583914669242297|<cline|<point|-3.9839146692423|0.09195733462115>|<point|-2.8160853307577|0.09195733462115>|<point|-2.8160853307577|-0.49195733462115>|<point|-3.9839146692423|-0.49195733462115>>>|<with|magnify|0.583914669242297|<line|<point|-3.4|0.09195733462115>|<point|-3.4|-0.49195733462115>>>|<with|magnify|0.583914669242297|<point|-3.69195733462115|-0.2>>|<with|magnify|0.583914669242297|<point|-3.10804266537885|-0.2>>|<with|arrow-end|\<gtr\>|<line|<point|-3.10804|-0.2>|<point|-1.6839146692423|-0.2>>>|<with|arrow-end|\<gtr\>|<line|<point|-1.79196|1.5>|<point|-1.8|0.8>|<point|-3.4|0.8>|<point|-3.4|0.09195733462115>>>|<with|magnify|0.590117724122821|<cline|<point|-1.69505886206141|-1.00494113793859>|<point|-1.10494113793859|-1.00494113793859>|<point|-1.10494113793859|-1.59505886206141>|<point|-1.69505886206141|-1.59505886206141>>>|<text-at|<scm|a>|<point|-1.53766372668342|-1.38462677476562>>|<with|magnify|0.583914669242297|<cline|<point|-1.6839146692423|0.09195733462115>|<point|-0.516085330757699|0.09195733462115>|<point|-0.516085330757699|-0.49195733462115>|<point|-1.6839146692423|-0.49195733462115>>>|<with|arrow-end|\<gtr\>|<line|<point|-1.39196|-0.2>|<point|-1.4|-1.0>>>|<with|magnify|0.583914669242297|<point|-1.39195733462115|-0.2>>|<text-at|<scm|dq>|<point|-3.38565165398442|1.4>>|<text-at|<scm|front-ptr>|<point|-3.3|0.5>>|<with|magnify|0.583914669242297|<line|<point|-1.1|0.09195733462115>|<point|-1.1|-0.49195733462115>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.9|1.5>|<point|-2.0839146692423|1.5>>>|<with|magnify|0.583914669242297|<cline|<point|-2.0839146692423|1.79195733462115>|<point|-0.9160853307577|1.79195733462115>|<point|-0.9160853307577|1.20804266537885>|<point|-2.0839146692423|1.20804266537885>>>|<with|magnify|0.583914669242297|<point|-0.80804266537885|-0.2>>|<with|arrow-end|\<gtr\>|<line|<point|-0.80804|-0.2>|<point|0.2|-0.2>>>|<with|magnify|0.583914669242297|<line|<point|-1.5|1.79195733462115>|<point|-1.5|1.20804266537885>>>|<with|magnify|0.583914669242297|<point|-1.79195733462115|1.5>>|<with|magnify|0.590117724122821|<cline|<point|0.204941137938588|-1.00494113793859>|<point|0.795058862061407|-1.00494113793859>|<point|0.795058862061407|-1.59505886206141>|<point|0.204941137938588|-1.59505886206141>>>|<with|arrow-end|\<gtr\>|<line|<point|-1.20804|1.5>|<point|2.6|1.5>|<point|2.6|0.09195733462115>>>|<with|magnify|0.583914669242297|<point|-1.20804266537885|1.5>>|<with|magnify|0.583914669242297|<cline|<point|0.216085330757698|0.09195733462115>|<point|1.3839146692423|0.09195733462115>|<point|1.3839146692423|-0.49195733462115>|<point|0.216085330757698|-0.49195733462115>>>|<text-at|<scm|b>|<point|0.362336273316579|-1.38462677476562>>|<with|arrow-end|\<gtr\>|<line|<point|0.508039999999998|-0.2>|<point|0.499999999999999|-1.0>>>|<with|magnify|0.583914669242297|<point|0.508042665378848|-0.2>>|<with|magnify|0.583914669242297|<line|<point|0.799999999999998|0.09195733462115>|<point|0.799999999999998|-0.49195733462115>>>|<with|magnify|0.583914669242297|<point|1.09195733462115|-0.2>>|<with|arrow-end|\<gtr\>|<line|<point|1.09196|-0.2>|<point|2.0|-0.2>>>|<with|magnify|0.590117724122821|<cline|<point|2.00494113793859|-1.00494113793859>|<point|2.59505886206141|-1.00494113793859>|<point|2.59505886206141|-1.59505886206141>|<point|2.00494113793859|-1.59505886206141>>>|<with|magnify|0.583914669242297|<cline|<point|2.0160853307577|0.09195733462115>|<point|3.1839146692423|0.09195733462115>|<point|3.1839146692423|-0.49195733462115>|<point|2.0160853307577|-0.49195733462115>>>|<text-at|<scm|c>|<point|2.16233627331658|-1.38462677476562>>|<with|arrow-end|\<gtr\>|<line|<point|2.30804|-0.2>|<point|2.3|-1.0>>>|<with|magnify|0.583914669242297|<point|2.30804266537885|-0.2>>|<line|<point|2.6|-0.491957>|<point|3.2|0.1>>|<with|magnify|0.583914669242297|<line|<point|2.6|0.09195733462115>|<point|2.6|-0.49195733462115>>>|<text-at|<scm|rear-ptr>|<point|2.8|0.6>>>>>|Result
      of using <scm|(front-insert-deque! dq 'z)> on the queue of figure
      <reference|Exercise_3.23-Figure_2>.>
    </float>. We first create a new pair whose <scm|car> is the item to be
    inserted and whose <scm|cdr> is the empty list. If the double-ended queue
    was initially empty, we set the front and rear pointers of the queue to
    this new pair. Otherwise, we modified this new pair to point to the first
    pair in the queue, and also set the front pointer to the new pair.

    <\scm-code>
      (define (front-insert-deque! deque item)

      \ \ (let ((new-pair (cons item '())))

      \ \ \ \ (cond ((empty-deque? deque)

      \ \ \ \ \ \ \ \ \ \ \ (set-front-ptr! deque new-pair)

      \ \ \ \ \ \ \ \ \ \ \ (set-rear-ptr! deque new-pair)

      \ \ \ \ \ \ \ \ \ \ \ deque)

      \ \ \ \ \ \ \ \ \ \ (else

      \ \ \ \ \ \ \ \ \ \ \ \ (set-cdr! new-pair front-ptr)

      \ \ \ \ \ \ \ \ \ \ \ \ (set-front-ptr! deque new-pair)

      \ \ \ \ \ \ \ \ \ \ \ \ deque))))
    </scm-code>

    <hspace|3ex>Inserting an item at the rear of a double-ended queue is
    simply the same as that of a single-ended queue (see figure
    <reference|Exercise_3.23-Figure_4><\float|float|tbh>
      <big-figure|<label|Exercise_3.23-Figure_4><with|gr-mode|<tuple|group-edit|group-ungroup>|gr-frame|<tuple|scale|1cm|<tuple|0.5gw|0.5gh>>|gr-geometry|<tuple|geometry|1par|0.6par>|gr-grid|<tuple|empty>|gr-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-edit-grid-aspect|<tuple|<tuple|axes|none>|<tuple|1|none>|<tuple|10|none>>|gr-edit-grid|<tuple|empty>|gr-edit-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-auto-crop|true|gr-arrow-end|\<gtr\>|<graphics||<gr-group|<with|magnify|0.590117724122821|<cline|<point|-2.89505886206141|-1.40494113793859>|<point|-2.30494113793859|-1.40494113793859>|<point|-2.30494113793859|-1.99505886206141>|<point|-2.89505886206141|-1.99505886206141>>>|<text-at|<scm|a>|<point|-2.73766372668342|-1.78462677476562>>|<with|arrow-end|\<gtr\>|<line|<point|-2.59196|-0.6>|<point|-2.6|-1.4>>>|<with|magnify|0.583914669242297|<cline|<point|-2.8839146692423|-0.30804266537885>|<point|-1.7160853307577|-0.30804266537885>|<point|-1.7160853307577|-0.89195733462115>|<point|-2.8839146692423|-0.89195733462115>>>|<with|magnify|0.583914669242297|<point|-2.59195733462115|-0.6>>|<with|magnify|0.583914669242297|<line|<point|-2.3|-0.30804266537885>|<point|-2.3|-0.89195733462115>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.59196|1.12348>|<point|-2.6|-0.28456266537885>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.00804|-0.6>|<point|-0.583914669242302|-0.6>>>|<with|magnify|0.583914669242297|<point|-2.00804266537885|-0.6>>|<text-at|<scm|dq>|<point|-4.18565165398442|1.02348>>|<with|arrow-end|\<gtr\>|<line|<point|-3.7|1.12348>|<point|-2.8839146692423|1.12348>>>|<with|magnify|0.583914669242297|<cline|<point|-2.8839146692423|1.41543733462115>|<point|-1.7160853307577|1.41543733462115>|<point|-1.7160853307577|0.83152266537885>|<point|-2.8839146692423|0.83152266537885>>>|<with|magnify|0.590117724122821|<cline|<point|-0.595058862061412|-1.40494113793859>|<point|-0.00494113793859315|-1.40494113793859>|<point|-0.00494113793859315|-1.99505886206141>|<point|-0.595058862061412|-1.99505886206141>>>|<with|magnify|0.583914669242297|<line|<point|-2.3|1.41543733462115>|<point|-2.3|0.83152266537885>>>|<with|magnify|0.583914669242297|<point|-2.59195733462115|1.12348>>|<with|magnify|0.583914669242297|<cline|<point|-0.583914669242302|-0.30804266537885>|<point|0.583914669242299|-0.30804266537885>|<point|0.583914669242299|-0.89195733462115>|<point|-0.583914669242302|-0.89195733462115>>>|<text-at|<scm|b>|<point|-0.437663726683422|-1.78462677476562>>|<with|arrow-end|\<gtr\>|<line|<point|-0.291960000000002|-0.6>|<point|-0.300000000000002|-1.4>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.00804|1.12348>|<point|3.6|1.12348>|<point|3.6|-0.27652>>>|<with|magnify|0.583914669242297|<point|-2.00804266537885|1.12348>>|<text-at|<scm|front-ptr>|<point|-2.4|0.22348>>|<with|magnify|0.583914669242297|<point|-0.291957334621152|-0.6>>|<with|magnify|0.583914669242297|<line|<point|-3.24740234702858e-15|-0.30804266537885>|<point|-3.24740234702858e-15|-0.89195733462115>>>|<with|magnify|0.583914669242297|<point|0.291957334621149|-0.6>>|<with|arrow-end|\<gtr\>|<line|<point|0.291959999999999|-0.6>|<point|1.2|-0.6>>>|<with|magnify|0.590117724122821|<cline|<point|1.20494113793859|-1.40494113793859>|<point|1.79505886206141|-1.40494113793859>|<point|1.79505886206141|-1.99505886206141>|<point|1.20494113793859|-1.99505886206141>>>|<with|magnify|0.583914669242297|<cline|<point|1.2160853307577|-0.30804266537885>|<point|2.3839146692423|-0.30804266537885>|<point|2.3839146692423|-0.89195733462115>|<point|1.2160853307577|-0.89195733462115>>>|<text-at|<scm|c>|<point|1.36233627331658|-1.78462677476562>>|<with|arrow-end|\<gtr\>|<line|<point|1.50804|-0.6>|<point|1.5|-1.4>>>|<with|magnify|0.583914669242297|<point|1.50804266537885|-0.6>>|<line|<point|1.8|-0.308043>|<point|1.8|-0.89195733462115>>|<with|magnify|0.583914669242297|<point|2.09195733462115|-0.6>>|<with|arrow-end|\<gtr\>|<line|<point|2.09196|-0.6>|<point|3.0|-0.6>>>|<with|magnify|0.590117724122821|<cline|<point|3.00494113793859|-1.39868918723282>|<point|3.59505886206141|-1.39868918723282>|<point|3.59505886206141|-1.98880691135564>|<point|3.00494113793859|-1.98880691135564>>>|<with|magnify|0.583914669242297|<cline|<point|3.0160853307577|-0.30179071467308>|<point|4.1839146692423|-0.30179071467308>|<point|4.1839146692423|-0.88570538391538>|<point|3.0160853307577|-0.88570538391538>>>|<text-at|<scm|d>|<point|3.16233627331658|-1.77837482405985>>|<with|arrow-end|\<gtr\>|<line|<point|3.30804|-0.59374804929423>|<point|3.3|-1.39374804929423>>>|<with|magnify|0.583914669242297|<point|3.30804266537885|-0.59374804929423>>|<with|magnify|0.583914669242297|<line|<point|3.6|-0.30179071467308>|<point|3.6|-0.88570538391538>>>|<line|<point|3.6|-0.88570504929423>|<point|4.2|-0.29374804929423>>|<text-at|<scm|rear-ptr>|<point|3.8|0.221693>>>>>|Result
      of using <scm|(rear-insert-deque! dq 'd)> on the queue of figure
      <reference|Exercise_3.23-Figure_2>.>
    </float>):

    <\scm-code>
      (define (rear-insert-deque! deque item)

      \ \ (let ((new-pair (cons item '())))

      \ \ \ \ (cond ((empty-deque? deque)

      \ \ \ \ \ \ \ \ \ \ \ (set-front-ptr! deque new-pair)

      \ \ \ \ \ \ \ \ \ \ \ (set-rear-ptr! deque new-pair)

      \ \ \ \ \ \ \ \ \ \ \ deque)

      \ \ \ \ \ \ \ \ \ \ (else

      \ \ \ \ \ \ \ \ \ \ \ \ (set-cdr! (rear-ptr deque) new-pair)

      \ \ \ \ \ \ \ \ \ \ \ \ (set-rear-ptr! deque new-pair)

      \ \ \ \ \ \ \ \ \ \ \ \ deque))))
    </scm-code>

    <hspace|3ex>To delete the item at the front of the double-ended queue, we
    merely follow the same way we did in the single-ended queue (see figure
    <reference|Exercise_3.23-Figure_5><\float|float|tbh>
      <big-figure|<label|Exercise_3.23-Figure_5><with|gr-mode|<tuple|group-edit|move>|gr-frame|<tuple|scale|1cm|<tuple|0.5gw|0.5gh>>|gr-geometry|<tuple|geometry|1par|0.6par>|gr-grid|<tuple|empty>|gr-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-edit-grid-aspect|<tuple|<tuple|axes|none>|<tuple|1|none>|<tuple|10|none>>|gr-edit-grid|<tuple|empty>|gr-edit-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-auto-crop|true|gr-arrow-end|\<gtr\>|<graphics||<gr-group|<with|magnify|0.590117724122821|<cline|<point|-3.89188635643897|-1.08515677492761>|<point|-3.30176863231615|-1.08515677492761>|<point|-3.30176863231615|-1.67527449905043>|<point|-3.89188635643897|-1.67527449905043>>>|<text-at|<scm|z>|<point|-3.73449122106098|-1.46484241175464>>|<with|magnify|0.583914669242297|<cline|<point|-3.88074216361986|0.01174169763213>|<point|-2.71291282513526|0.01174169763213>|<point|-2.71291282513526|-0.57217297161017>|<point|-3.88074216361986|-0.57217297161017>>>|<with|arrow-end|\<gtr\>|<line|<point|-3.58878749437756|-0.28021563698902>|<point|-3.59682749437756|-1.08021563698902>>>|<with|magnify|0.583914669242297|<point|-3.58878482899871|-0.28021563698902>>|<with|magnify|0.583914669242297|<line|<point|-3.29682749437756|0.01174169763213>|<point|-3.29682749437756|-0.57217297161017>>>|<text-at|<scm|dq>|<point|-5.13682165398442|1.3>>|<with|arrow-end|\<gtr\>|<line|<point|-4.65117|1.4>|<point|-3.8350846692423|1.4>>>|<with|magnify|0.583914669242297|<point|-3.00487015975641|-0.28021563698902>>|<with|arrow-end|\<gtr\>|<line|<point|-3.00486749437756|-0.28021563698902>|<point|-1.58074216361986|-0.28021563698902>>>|<with|arrow-end|\<gtr\>|<line|<point|-3.54313|1.4>|<point|-3.55117|0.7>|<point|-0.95117|0.7>|<point|-0.95117|-0.00804266537885012>>>|<with|magnify|0.583914669242297|<cline|<point|-3.8350846692423|1.69195733462115>|<point|-2.6672553307577|1.69195733462115>|<point|-2.6672553307577|1.10804266537885>|<point|-3.8350846692423|1.10804266537885>>>|<with|magnify|0.583914669242297|<line|<point|-3.25117|1.69195733462115>|<point|-3.25117|1.10804266537885>>>|<with|magnify|0.583914669242297|<point|-3.54312733462115|1.4>>|<with|arrow-end|\<gtr\>|<line|<point|-2.95921|1.4>|<point|2.7|1.4>|<point|2.7|-2.77555756156289e-17>>>|<with|magnify|0.583914669242297|<point|-2.95921266537885|1.4>>|<with|magnify|0.590117724122821|<cline|<point|-1.54622886206141|-1.10494113793859>|<point|-0.95611113793859|-1.10494113793859>|<point|-0.95611113793859|-1.69505886206141>|<point|-1.54622886206141|-1.69505886206141>>>|<with|magnify|0.583914669242297|<cline|<point|-1.5350846692423|-0.00804266537885012>|<point|-0.367255330757698|-0.00804266537885012>|<point|-0.367255330757698|-0.59195733462115>|<point|-1.5350846692423|-0.59195733462115>>>|<text-at|<scm|a>|<point|-1.38883372668342|-1.48462677476562>>|<with|arrow-end|\<gtr\>|<line|<point|-1.24313|-0.3>|<point|-1.25117|-1.1>>>|<text-at|<scm|front-ptr>|<point|-3.05117|0.4>>|<with|magnify|0.583914669242297|<point|-1.24312733462115|-0.3>>|<with|magnify|0.583914669242297|<line|<point|-0.95117|-0.00804266537885012>|<point|-0.95117|-0.59195733462115>>>|<with|arrow-end|\<gtr\>|<line|<point|-0.659209999999999|-0.3>|<point|0.34883|-0.3>>>|<with|magnify|0.583914669242297|<point|-0.659212665378849|-0.3>>|<with|magnify|0.590117724122821|<cline|<point|0.35377113793859|-1.10494113793859>|<point|0.943888862061409|-1.10494113793859>|<point|0.943888862061409|-1.69505886206141>|<point|0.35377113793859|-1.69505886206141>>>|<with|magnify|0.583914669242297|<cline|<point|0.3649153307577|-0.00804266537885012>|<point|1.5327446692423|-0.00804266537885012>|<point|1.5327446692423|-0.59195733462115>|<point|0.3649153307577|-0.59195733462115>>>|<text-at|<scm|b>|<point|0.511166273316579|-1.48462677476562>>|<with|arrow-end|\<gtr\>|<line|<point|0.65687|-0.3>|<point|0.64883|-1.1>>>|<with|magnify|0.583914669242297|<point|0.656872665378849|-0.3>>|<with|magnify|0.583914669242297|<line|<point|0.948829999999999|-0.00804266537885012>|<point|0.948829999999999|-0.59195733462115>>>|<with|magnify|0.583914669242297|<point|1.24078733462115|-0.3>>|<with|arrow-end|\<gtr\>|<line|<point|1.24079|-0.3>|<point|2.14883|-0.3>>>|<with|magnify|0.590117724122821|<cline|<point|2.15377113793859|-1.10494113793859>|<point|2.74388886206141|-1.10494113793859>|<point|2.74388886206141|-1.69505886206141>|<point|2.15377113793859|-1.69505886206141>>>|<with|magnify|0.583914669242297|<cline|<point|2.1649153307577|-0.00804266537885012>|<point|3.3327446692423|-0.00804266537885012>|<point|3.3327446692423|-0.59195733462115>|<point|2.1649153307577|-0.59195733462115>>>|<text-at|<scm|c>|<point|2.31116627331658|-1.48462677476562>>|<with|arrow-end|\<gtr\>|<line|<point|2.45687|-0.3>|<point|2.44883|-1.1>>>|<with|magnify|0.583914669242297|<point|2.45687266537885|-0.3>>|<line|<point|2.74883|-0.591957>|<point|3.34883|-2.77555756156289e-17>>|<with|magnify|0.583914669242297|<line|<point|2.74883|-0.00804266537885012>|<point|2.74883|-0.59195733462115>>>|<text-at|<scm|rear-ptr>|<point|2.84883|0.43865946080137>>>>>|Result
      of using <scm|(front-delete-deque! dq)> on the queue of figure
      <reference|Exercise_3.23-Figure_3>.>
    </float>):

    <\scm-code>
      (define (front-delete-deque! deque)

      \ \ (cond ((empty-deque? deque)

      \ \ \ \ \ \ \ \ \ (error "FRONT-DELETE-DEQUE! called with an empty
      queue" deque))

      \ \ \ \ \ \ \ \ (else

      \ \ \ \ \ \ \ \ \ \ (set-front-ptr! deque (cdr (front-ptr deque)))

      \ \ \ \ \ \ \ \ \ \ deque)))
    </scm-code>

    <hspace|3ex>Deleting an item at the rear of the double-ended queue,
    however, is a little bit complex. If the double-ended queue was initially
    empty, we just report an error and exit. Otherwise, if the queue contains
    only one item, we simply set the front pointer to the empty list. In the
    case where the queue is consisted of more than one item, we first
    traverse the queue to find the item just before the last item, set the
    rear pointer to it and assign its cdr to the empty list. Figure
    <reference|Exercise_3.23-Figure_6><\float|float|tbh>
      <big-figure|<label|Exercise_3.23-Figure_6><with|gr-mode|<tuple|edit|line>|gr-frame|<tuple|scale|1cm|<tuple|0.5gw|0.5gh>>|gr-geometry|<tuple|geometry|1par|0.6par>|gr-grid|<tuple|empty>|gr-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-edit-grid-aspect|<tuple|<tuple|axes|none>|<tuple|1|none>|<tuple|10|none>>|gr-edit-grid|<tuple|empty>|gr-edit-grid-old|<tuple|cartesian|<point|0|0>|1>|gr-auto-crop|true|<graphics||<gr-group|<with|magnify|0.590117724122821|<cline|<point|-2.89505886206141|-1.40494113793859>|<point|-2.30494113793859|-1.40494113793859>|<point|-2.30494113793859|-1.99505886206141>|<point|-2.89505886206141|-1.99505886206141>>>|<text-at|<scm|a>|<point|-2.73766372668342|-1.78462677476562>>|<with|magnify|0.583914669242297|<cline|<point|-2.8839146692423|-0.30804266537885>|<point|-1.7160853307577|-0.30804266537885>|<point|-1.7160853307577|-0.89195733462115>|<point|-2.8839146692423|-0.89195733462115>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.59196|-0.6>|<point|-2.6|-1.4>>>|<with|magnify|0.583914669242297|<point|-2.59195733462115|-0.6>>|<with|magnify|0.583914669242297|<line|<point|-2.3|-0.30804266537885>|<point|-2.3|-0.89195733462115>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.59196|1.12348>|<point|-2.6|-0.28456266537885>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.00804|-0.6>|<point|-0.583914669242302|-0.6>>>|<with|magnify|0.583914669242297|<point|-2.00804266537885|-0.6>>|<text-at|<scm|dq>|<point|-4.18565165398442|1.02348>>|<with|arrow-end|\<gtr\>|<line|<point|-3.7|1.12348>|<point|-2.8839146692423|1.12348>>>|<with|magnify|0.583914669242297|<cline|<point|-2.8839146692423|1.41543733462115>|<point|-1.7160853307577|1.41543733462115>|<point|-1.7160853307577|0.83152266537885>|<point|-2.8839146692423|0.83152266537885>>>|<with|magnify|0.583914669242297|<line|<point|-2.3|1.41543733462115>|<point|-2.3|0.83152266537885>>>|<with|magnify|0.583914669242297|<point|-2.59195733462115|1.12348>>|<with|magnify|0.590117724122821|<cline|<point|-0.595058862061412|-1.40494113793859>|<point|-0.00494113793859315|-1.40494113793859>|<point|-0.00494113793859315|-1.99505886206141>|<point|-0.595058862061412|-1.99505886206141>>>|<with|arrow-end|\<gtr\>|<line|<point|-2.00804|1.12348>|<point|3.6|1.12348>|<point|3.6|0.6>|<point|1.8|0.6>|<point|1.8|-0.30804266537885>>>|<with|magnify|0.583914669242297|<point|-2.00804266537885|1.12348>>|<with|magnify|0.583914669242297|<cline|<point|-0.583914669242302|-0.30804266537885>|<point|0.583914669242299|-0.30804266537885>|<point|0.583914669242299|-0.89195733462115>|<point|-0.583914669242302|-0.89195733462115>>>|<text-at|<scm|b>|<point|-0.437663726683422|-1.78462677476562>>|<with|arrow-end|\<gtr\>|<line|<point|-0.291960000000002|-0.6>|<point|-0.300000000000002|-1.4>>>|<text-at|<scm|front-ptr>|<point|-2.4|0.22348>>|<with|magnify|0.583914669242297|<point|-0.291957334621152|-0.6>>|<with|magnify|0.583914669242297|<line|<point|-3.24740234702858e-15|-0.30804266537885>|<point|-3.24740234702858e-15|-0.89195733462115>>>|<with|magnify|0.583914669242297|<point|0.291957334621149|-0.6>>|<with|arrow-end|\<gtr\>|<line|<point|0.291959999999999|-0.6>|<point|1.2|-0.6>>>|<with|magnify|0.590117724122821|<cline|<point|1.20494113793859|-1.40494113793859>|<point|1.79505886206141|-1.40494113793859>|<point|1.79505886206141|-1.99505886206141>|<point|1.20494113793859|-1.99505886206141>>>|<with|magnify|0.583914669242297|<cline|<point|1.2160853307577|-0.30804266537885>|<point|2.3839146692423|-0.30804266537885>|<point|2.3839146692423|-0.89195733462115>|<point|1.2160853307577|-0.89195733462115>>>|<text-at|<scm|c>|<point|1.36233627331658|-1.78462677476562>>|<with|arrow-end|\<gtr\>|<line|<point|1.50804|-0.6>|<point|1.5|-1.4>>>|<with|magnify|0.583914669242297|<point|1.50804266537885|-0.6>>|<line|<point|2.4|-0.3>|<point|1.8|-0.89195733462115>>|<line|<point|1.8|-0.308043>|<point|1.8|-0.89195733462115>>|<with|magnify|0.590117724122821|<cline|<point|3.00494113793859|-1.39868918723282>|<point|3.59505886206141|-1.39868918723282>|<point|3.59505886206141|-1.98880691135564>|<point|3.00494113793859|-1.98880691135564>>>|<with|magnify|0.583914669242297|<cline|<point|3.0160853307577|-0.30179071467308>|<point|4.1839146692423|-0.30179071467308>|<point|4.1839146692423|-0.88570538391538>|<point|3.0160853307577|-0.88570538391538>>>|<text-at|<scm|d>|<point|3.16233627331658|-1.77837482405985>>|<with|arrow-end|\<gtr\>|<line|<point|3.30804|-0.59374804929423>|<point|3.3|-1.39374804929423>>>|<with|magnify|0.583914669242297|<point|3.30804266537885|-0.59374804929423>>|<with|magnify|0.583914669242297|<line|<point|3.6|-0.30179071467308>|<point|3.6|-0.88570538391538>>>|<line|<point|3.6|-0.88570504929423>|<point|4.2|-0.29374804929423>>|<text-at|<scm|rear-ptr>|<point|1.99869686814001|0.22125312700093>>>>>|Result
      of using <scm|(rear-delete-deque! dq)> on the queue of figure
      <reference|Exercise_3.23-Figure_4>.>
    </float> illustrate the evolution of the double-ended queue in a more
    intuitive way.

    <\scm-code>
      (define (delete-rear-deque! deque)

      \ \ (define (find-one-before-last L)

      \ \ \ \ (cond ((null? L)

      \ \ \ \ \ \ \ \ \ \ \ (error "FIND-ONE-BEFORE-LAST empty list" L))

      \ \ \ \ \ \ \ \ \ \ ((null? (cdr (cdr L)))

      \ \ \ \ \ \ \ \ \ \ \ L)

      \ \ \ \ \ \ \ \ \ \ (else

      \ \ \ \ \ \ \ \ \ \ \ \ (find-one-before-last (cdr L)))))

      \ \ (cond ((empty-deque? deque)

      \ \ \ \ \ \ \ \ \ (error "REAR-DELETE-DEQUE! called with an empty
      queue" deque))

      \ \ \ \ \ \ \ \ ((null? (cdr (front-ptr deque))) ; the queue consist of
      only 1 item

      \ \ \ \ \ \ \ \ \ (set-front-ptr! deque '())

      \ \ \ \ \ \ \ \ \ deque)

      \ \ \ \ \ \ \ \ (else ; the queue is made up of more than 1 item

      \ \ \ \ \ \ \ \ \ \ (let (new-last (find-one-before-last (front-ptr
      deque)))

      \ \ \ \ \ \ \ \ \ \ \ \ (set-rear-ptr! deque new-last)

      \ \ \ \ \ \ \ \ \ \ \ \ (set-cdr! new-last '())

      \ \ \ \ \ \ \ \ \ \ \ \ deque))))
    </scm-code>
  </render-exercise>
</body>

<\initial>
  <\collection>
    <associate|font-base-size|11>
  </collection>
</initial>

<\references>
  <\collection>
    <associate|E|<tuple|6|?>>
    <associate|Exercise_3.23-Figure_1|<tuple|1|?>>
    <associate|Exercise_3.23-Figure_2|<tuple|2|?>>
    <associate|Exercise_3.23-Figure_3|<tuple|3|?>>
    <associate|Exercise_3.23-Figure_4|<tuple|4|?>>
    <associate|Exercise_3.23-Figure_5|<tuple|5|?>>
    <associate|Exercise_3.23-Figure_6|<tuple|6|?>>
    <associate|auto-1|<tuple|1|?>>
    <associate|auto-2|<tuple|2|?>>
    <associate|auto-3|<tuple|3|?>>
    <associate|auto-4|<tuple|4|?>>
    <associate|auto-5|<tuple|5|?>>
    <associate|auto-6|<tuple|6|?>>
    <associate|footnote-|<tuple|?|?>>
    <associate|footnote-*|<tuple|?|?>>
    <associate|footnote-1|<tuple|1|?>>
    <associate|footnr-1|<tuple|1|?>>
  </collection>
</references>

<\auxiliary>
  <\collection>
    <\associate|figure>
      <tuple|normal|Double-ended queue operations.|<pageref|auto-1>>

      <tuple|normal|Implementation of a double-ended queue as a list with
      front and rear pointers.|<pageref|auto-2>>

      <tuple|normal|Result of using <with|mode|<quote|prog>|prog-language|<quote|scheme>|(front-insert-deque!
      dq 'z)> on the queue of figure <reference|Exercise_3.23-Figure_2>.|<pageref|auto-3>>

      <tuple|normal||<pageref|auto-4>>
    </associate>
  </collection>
</auxiliary>